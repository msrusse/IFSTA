
		/*
 * Copyright (C) 2007 Trivantis Corporation
 */

	
function jsWndObj(){var A=this;A.actFlags=0;A.bLButtonDown=0;A.cwObj=n;A.rtRect=new jsRect(0,0,0,0);A.name=n;A.div=n;A.ptPending=new jsPoint(-1,-1);A.ptPending.x=n;A.ptDown=new jsPoint(-0,0);A.dCon=n;A.idSize=n;A.rectSize=n;A.zindex=0;A.bEnabled=1;A.currTrans=0;A.rcdData=new jsRcdAttachData();A.rcdState=new jsRcdState();if (A.designTime){jsWndObj.prototype.designTime.call(A);A.designTime();}};var p=jsWndObj.prototype;p.attach=function(A){var B=this,C=B.rcdGetAttData(),D=C.htmlId,E=C.objData,F=C.bInsAnc,G=E.a;B.div=document.getElementById(D);if (B.div){B.div.tObj=B;var H=String(B.div.id);while (H&&H.length&&isNaN(H)) H=H.substring(1);if (H&&H.length){var I=document.createElement('A');I.name=String(H)+'anc';var J="javascript://"+H;var K=B.div.firstChild;I.href=J;if (E.altValue) I.setAttribute("aria-label",E.altValue);if (E.titleValue) I.setAttribute("title",E.titleValue);if (F&&K){B.div.removeChild(K);B.div.appendChild(I);I.appendChild(K);if (K.style.position=='absolute'){I.style.width=K.style.width;I.style.height=K.style.height;I.style.position='absolute';}}}};B.parPage=trivPage;B.actFlags=G[0];B.dwFlags=G[1];var L=B.cwObj,M=(L&&L.par)?L.par:n;L=new cwObjPub();B.cwObj=L;L.wnd=B;L.par=M;L.transData=G[2];B.rtRect.set(G[3][0],G[3][1],G[3][2],G[3][3]);if (L.getTrans(t)||L.getTrans(f)){L.rect=B.rtRect.copy();if (typeof G[2][6]!='undefined'){L.rect.x=G[2][6];L.rect.y=G[2][7];}};var N=L.getTrans(t);if (B.div&&N&&!A){if (!jsTrans.isFIFO(N)||jsTrans.isFloat(N)) B.div.style.visibility='hidden';};B.bLiveWin=E.bLiveWin;if (B.div&&A){if (N&&N>=24&&N<=34){B.div.style.left=L.transData[6]+'px';B.div.style.top=L.transData[7]+'px';}};if (C.cwObj){for (var O in C.cwObj) L[O]=C.cwObj[O];}};p.postAttach=function(A) {};p.isValidWndObj=function(){return 	this.cwObj!=u&&this.dCon!=u&&this.div.firstChild!=u;};p.rcdGetAttData=function() {var A=this.rcdData['att_'+rcdObj.view];if (A==u) A=this.rcdData['att_'+DEFAULT_VIEW];return A;};p.updateDiv=function(A){var B=this,C=B.rcdGetAttData(),D=f,E=B.div;if (!E){E=document.createElement('div');B.div=E;var F=E;if (C.fieldsetId){F=document.getElementById(C.fieldsetId);if (!F){F=document.createElement('fieldset');F.id=C.fieldsetId;var G=F.style;G.border='0';G.fontSize='1px';G.width='1px';G.height='1px';};F.appendChild(E);};document.getElementById('wndPage').appendChild(F);}else D=E.style.visibility;if (!A){if (C.dynText) C.innerHtml=B.getDynText(C.dynText);E.innerHTML=C.innerHtml;E.id=C.htmlId;};E.style.cssText=C.cssText;if (theApp.is.ie9) E.style.filter='';if (D!==f) E.style.visibility=D;var H=[];if(C.cssClasses.length) H=C.cssClasses.split(',');for (var i=0;i<H.length;i++){var I=H[i].trim();var J=[];if(E.className.length) J=E.className.split(" ");if(I&&(J.indexOf(I)==-1)) E.className+=" "+I;}};p.editMode=function() {return (this.designTime&&titleData.mode==1);};p.runMode=function() {return (this.designTime&&titleData.mode==2);};p.mouseDown=function(e){var A=this;if (A.editMode()) A.mouseDownEdit(e);else{if(e.which==1||(e.which==n&&(e.button==0||e.button==1))){A.bLButtonDown=1;var B=A.cwObj;if(A.designTime&&B&&B.par&&B.par.type==13){var C=B.par.isLiveQuestObject(B);if(C) A.parPage.questObjMouseDown(A,e,C);} else if(!A.designTime){if (A.down) return A.down();}}}};p.mouseMove=function(e){var A=this;if (A.editMode()) A.mouseMoveEdit(e);else{var B=A.cwObj;if(A.designTime&&B&&B.par&&B.par.type==13){var C=B.par.isLiveQuestObject(B);if(C) A.parPage.questObjMouseMove(A,e,C);}}};p.mouseUp=function(e){var A=this;if(A.parPage.rtData1!=-1){if(document.releaseEvents) document.releaseEvents(Event.MOUSEMOVE);if(document.releaseEvents) document.releaseEvents(Event.MOUSEUP);document.onmousemove=A.parPage.rtData1;document.onmouseup=A.parPage.rtData2;A.parPage.rtData1=-1;A.parPage.rtData2=-1;};if (A.editMode()) A.mouseUpEdit(e);else{try{if (A.bLButtonDown&&(A.actFlags&0x4)) A.issueActions(2);var B=A.cwObj;if (A.designTime&&B&&B.par&&B.par.type==13){var C=B.par.isLiveQuestObject(B);if (C) A.parPage.questObjMouseUp(A,e,C);}} finally{A.bLButtonDown=0;}}};p.mouseEnter=function(){if (!(this.editMode())) if (this.actFlags&0x1) this.issueActions(0);};p.mouseExit=function(){if (!(this.editMode())) if (this.actFlags&0x2) this.issueActions(1);};p.mouseDblClk=function(e){if (this.editMode()) this.mouseDblClkEdit(e);else if (this.actFlags&0x8) this.issueActions(3);};p.contextMenu=function(e){if (this.editMode()) this.contextMenuEdit(e);else if (this.actFlags&0x200){this.issueActions(9);return cancelEvent(e);};if (this.designTime) return cancelEvent(e);};p.isPlaying=function(){return f;};p.play=function(){};p.actionPlay=p.play;p.stop=function(){};p.actionStop=p.stop;p.isVisible=function(){return (this.div&&this.div.style.visibility!='hidden');};p.processEffects=function(A){if(A===undefined) return;var B=this;if(!A[0].supportsSVG()) return;if (!B.editMode()&&!B.runMode()){trivArExec(A,function(C){C.process(B);});}else{trivArExec(A,function(D){switch(D.effType){case 23:D.dtProcess(B);break;case 24:D.process(B);break;}});}};p.updateEffectsPos=function(A){if(A===undefined) return;var B=this;if(!A[0].supportsSVG()) return;trivArExec(A,function(C){C.updatePos(B);});};p.show=function(){var A=this;if (A.div){var B=A.div.style,C=window.titleData&&(titleData.publishTextOnly||titleData.isPrinting)?t:f;if (!A.editMode()){var D=A.isVisible();if (!A.bShown){A.bShown=t;D=f;};if (C) B.visibility='inherit';else{if (D||A.isTransitioning(t)) return;if (A.isTransitioning(f)) A.cancelTrans();if ((!A.cwObj)||!A.cwObj.getTrans||!A.cwObj.getTrans(t)){B.visibility='inherit';A.processEffects(A.arEffects);}};if (A.actFlags&0x20){A.processEffects(A.arEffects);A.issueActions(5);}}else{B.visibility='inherit';A.processEffects(A.arEffects);}}};p.actionShow=p.show;p.hide=function(){var A=this;if (!(A.editMode())){if (A.isVisible()==f||A.isTransitioning(f)||!A.div) return;if (A.isTransitioning(t)) A.cancelTrans();if ((!A.cwObj)||!A.cwObj.getTrans(f)) A.div.style.visibility='hidden';if (A.actFlags&0x100) A.issueActions(8);A.processEffects(A.arEffects);}else if (A.div){A.div.style.visibility='hidden';A.processEffects(A.arEffects);}};p.actionHide=p.hide;p.actionTogglePlay=p.togglePlay;p.actionToggleShow=p.toggleShow;p.issueActions=function(A){var B=this;var C=B.cwObj;var D=window.titleData&&(titleData.publishTextOnly||titleData.isPrinting)?true:false;if(!D){if ((A==5&&C.getTrans(t))||(A==8&&C.getTrans(f))){if(B.timerIn) clearTimer(B.timerIn);if(B.timerOut) clearTimer(B.timerOut);if(B.currTrans&&B.transTmrId){clearTimeout(B.transTmrId);B.transTmrId=n;B.transDone(B);};if(!B.currTrans) B.setTrans(A==5);var E=C.getTransDelay(A==5);trivLogMsg("Transition started to "+(A==5?"show":"hide")+" ["+B.div.id+"] with a "+E+"ms delay",4);if(A==5) B.parPage.arTransInWnds.push(B);else B.parPage.arTransOutWnds.push(B);if(E) B.transTmrId=setTimeout(function(){ B.transTmrId=n;B.doTrans(A==5);},E);else B.doTrans(A==5);return;}};B.issueActionsInternal(A,D);};p.issueActionsInternal=function(A,B){var C=this,D=C.cwObj,E=C.parPage,F=E?E.arDelayAct:n,G=C.designTime?wndPage.currPage:0;if (D==u||E==u||(C.div&&C.div.innerHTML=='')) return;trivArExec(D.arChld,function(I,i){if (C.designTime&&G!==wndPage.currPage) return f;if(I.type==6&&I.on==A){if (!I.delay){if (B&&triv$.inArray(I.actItem.action,[8,11,22,23,28,3,4,37])<0) return;E.doAction(I.actItem,I.elseItem,I);}else if (!B){var H=setTimeout(function(){for(var j=0;j<F.length;j++) {if(F[j]==H){F.splice(j,1);break;}};E.doAction(I.actItem,I.elseItem,I);},I.delay);F.push(H);}}});};p.isTransitioning=function(A){var B=this.div;if(B&&B.bTrans&&B.bIn==A) return t;return f;};p.cancelTrans=function(){var A=this;var B=A.div;B.bTrans=f;if(jsTrans.isFIFO(A.currTrans)){B.style.left=B.fX+'px';B.style.top=B.fY+'px';if(!B.bIn) B.style.visibility="hidden";}else B.style.clip="rect(0px "+A.cwObj.getPubWidth()+"px "+A.cwObj.getPubHeight()+"px 0px)";A.transDone(A);};p.updatePosForTrans=function(A){var B=this;var C=B.cwObj;var D=B.rtRect;var E=B.currTrans;var F=B.parPage;var G=20;var H=new jsRect(C.getPubXPos(F.currPage),C.getPubYPos(F.currPage),C.getPubWidth(),C.getPubHeight());if(B.bHasMoved){H.x=D.x;H.y=D.y;};if(B.bHasSized){H.width=D.width;H.height=D.height;};D.setRect(H);var I=new jsRect(0,0,parseInt(F.div.style.width),parseInt(F.div.style.height));if (B.designTime){var J=C.par;var K=n;while(J){var L=titleData.isGroup(J);if (!L) break;if(J.getTrans(A)) K=J;J=J.par;};if(K){var M=H.copy();K.getBoundingRect(M,F.currPage);if(A){if(E==31||E==30||E==29) I.x-=(M.right()-H.right());if(E==31||E==24||E==25) I.y-=(M.bottom()-H.bottom());if(E==25||E==26||E==27) I.width+=(H.x-M.x);if(E==29||E==28||E==27) I.height+=(H.y-M.y);}else{if(E==31||E==30||E==29) I.x-=(M.right()-H.right());if(E==31||E==24||E==25) I.y-=(M.bottom()-H.bottom());if(E==25||E==26||E==27) I.width+=(H.x-M.x);if(E==29||E==28||E==27) I.height+=(H.y-M.y);}}};if(A){if(E==31||E==30||E==29){D.x=I.x-G-H.width;}else if(E==25||E==26||E==27){D.x=I.right()+G+H.width;};if(E==25||E==24||E==31){D.y=I.y-G-H.height;}else if(E==27||E==28||E==29){D.y=I.bottom()+G+H.height;};B.moveTo(D.x,D.y);}else{B.rectTransOut=H.copy();if(E==31||E==30||E==29){B.rectTransOut.x=I.x-G-H.width;}else if(E==25||E==26||E==27){B.rectTransOut.x=I.right()+G+H.width;};if(E==25||E==24||E==31){B.rectTransOut.y=I.y-G-H.height;}else if(E==27||E==28||E==29){B.rectTransOut.y=I.bottom()+G+H.width;}}};p.doTrans=function(A,B,C,D){var E=this;var F=E.div;if (!F) return;if(jsTrans.isFIFO(E.currTrans)){if(A) doDivTrans(f,F,E.currTrans,(11-E.cwObj.getTransSpeed(A)),C?C:E.transDone,E,E.cwObj.getPubXPos(),E.cwObj.getPubYPos(),E.cwObj.getTransEffect(A));else if(E.rectTransOut) doDivTrans(t,F,E.currTrans,(11-E.cwObj.getTransSpeed(A)),C?C:E.transDone,E,E.rectTransOut.x,E.rectTransOut.y,E.cwObj.getTransEffect(A));else E.currTrans=0;}else doDivTrans(!A,F,E.currTrans,(11-E.cwObj.getTransSpeed(A)),C?C:E.transDone,E);};p.transDone=function(A){if(!A.div) return;A.currTrans=0;A.rtRect.x=parseInt(A.div.style.left);A.rtRect.y=parseInt(A.div.style.top);var i=0;for(i=0;i<A.parPage.arTransInWnds.length;i++){if(A.parPage.arTransInWnds[i]==A){A.parPage.arTransInWnds.splice(i,1);if(A.actFlags&0x20) A.issueActionsInternal(5);return;}};for(i=0;i<A.parPage.arTransOutWnds.length;i++){if(A.parPage.arTransOutWnds[i]==A){A.parPage.arTransOutWnds.splice(i,1);if(A.actFlags&0x100) A.issueActionsInternal(8);break;}};if(!A.parPage.arTransOutWnds.length&&A.parPage.fDelayedSwitch){A.parPage.switchPage(A.parPage.nextPage,0,A.parPage._bNoFeedback==undefined?0:A.parPage._bNoFeedback,1);}};p.setTrans=function(A){var B=this;B.currTrans=B.cwObj.getTrans(A);if(B.currTrans){B.currTrans=jsTrans.xlateTrans(B.currTrans,B.cwObj.objType,n,B.cwObj.bLiveWin);B.updatePosForTrans(A);}};p.toggleVisibility=function(){if (this.isVisible()) this.hide();else this.show();};p.enable=function(A){this.bEnabled=A;};p.getRect=function(){return (this.rtRect.copy());};p.moveTo=function(x,y){var A=this;A.rtRect.x=parseInt(x);A.rtRect.y=parseInt(y);if (A.div){A.div.style.left=x+'px';A.div.style.top=y+'px';A.updateEffectsPos(A.arEffects);}};p.moveBy=function(x,y){var A=this;var B=A.rtRect;var C=A.div;B.x+=x;B.y+=y;if (C){C.style.left=parseInt(B.x)+'px';C.style.top=parseInt(B.y)+'px';A.updateEffectsPos(A.arEffects);}};p.sizeTo=function(w,h,A){var B=this;if(w<0)w=0;if(h<0)h=0;B.rtRect.width=w;B.rtRect.height=h;if (B.div){B.div.style.width=w+'px';B.div.style.height=h+'px';if(!isNaN(A)) B.div.style.fontSize=A+'pt';};if(B.dCon){B.dCon.style.width=w+'px';B.dCon.style.height=h+'px';if(!isNaN(A)) B.dCon.style.fontSize=A+'pt';};B.processEffects(B.arEffects);};p.flsLoading=function(A){if (!A||typeof A.PercentLoaded=='undefined') return t;return (A.PercentLoaded()!=100);};p.enableEventHandlers=function(){return t;};p.initEvents=function(){var A=this;if (A.useHTML5Player()&&A.mePlayer&&A.enableEventHandlers()){var B=A.cwObj||A.audio.cwObj;if (B&&B.arEvents&&B.arEvents.length){triv$(A.mePlayer).bind('timeupdate',function(){trivArExec(B.arEvents,function(E){var C=A&&A.enableEventHandlers()&&A.mePlayer;if (C){var D=Number(E.value)/1000;if (!E.proc&&C.currentTime>=D&&C.currentTime<=C.duration){E.proc=true;A.onEvent(E.name);}}});if (A&&A.clearEventsFlag&&A.mePlayer) A.clearEventsFlag(A.mePlayer.currentTime);});triv$(A.mePlayer).bind('ended',function(){if (A&&A.clearEventsFlag) A.clearEventsFlag(-1);});}}};p.clearEventsFlag=function(A){var B=this.cwObj||this.audio.cwObj;trivArExec(B&&B.arEvents,function(C){if (C&&C.proc&&(A===-1||A<(Number(C.value)/1000))) C.proc=f;});};p.updateIndicators=function(A){var B=this;if(!this.div||!trivPageTracking||!B.arrStatusImages||B.arrStatusImages.length!=3) return;var C=A;if(C==undefined||C.length==0) C=this.div.getElementsByTagName('IMG');if (C) for(var D=0;D<C.length;D++) {if(C[D]&&C[D].id.substring(0,8)=='TOCPTIND'){var E=C[D].id.substring(8);var F=C[D].src;var G=trivPageTracking.GetRangeStatus(E);G=G=="complete"?2:(G=="inprogress"?1:0);var H=F.lastIndexOf("/");var I=B.arrStatusImages[G];if(H!=-1){C[D].src=F.substring(0,H+1)+(I.length?I:B.arrStatusImages[2]);C[D].style.visibility=I.length?'':'hidden';}}}};p.getDynText=function(A){if (!trivPage.dynTextXML){var B=getHTTP('dyntitle.xml','GET',null);if(B.status!=200&&B.status!=0){trivAlert('LOADTESTERR',tn,getLocStr(trivstrErrLoadTestServer,B.status,B.statusText));return;};var C=0;if ((!B.responseXML)||B.responseXML.documentElement===null||B.responseXML.getElementsByTagName("parsererror").length>0){if (is.ie10orLess&&B.responseXML.documentElement===null&&B.responseXML.getElementsByTagName("parsererror").length<1){var D=new ActiveXObject("Microsoft.XMLDOM");if (D){D.async="false";D.loadXML(B.responseText);C=D.documentElement;}}};var E=(C?C:B.responseXML.documentElement);if(!E&&window.ActiveXObject){E=new ActiveXObject("Microsoft.XMLDOM");E.async="false";E.load(xfn);if (!(E&&E.parseError&&E.parseError.errorCode==0)){E=null;}};if (!E){trivAlert('LOADTESTERR',tn,getLocStr(trivstrErrLoadTestXml,fn));return '';};trivPage.dynTextXML=E;};var E=trivPage.dynTextXML.getElementsByTagName('textblock');for (var i=0;i<E.length;i++) if (E.item(i).getAttribute('name')==A) return E.item(i).childNodes[1].textContent;return 'NOT FOUND';};p.onEvent=function(A){var B=this.cwObj;trivLogMsg("Event ["+A+"] fired!",4);if (!B.hasEvents()) return;var C=this.designTime?wndPage:trivPage;trivArExec(B.arEvents,function(o,i){if (o.name==A) C.doAction(o.actItem,n,B);});};p.onDone=function(){if (this.actFlags&0x40) this.issueActions(6);};p.useHTML5Player=function(){var A=this;var B=A.snd?A.snd.div:A.div;return triv$('audio',B).length+triv$('video',B).length;};p.setCCState=function(A){var B=this.mePlayer;if (B&&B.player){var C='#'+B.player.id+'_captions_'+A;B.player.options.startLanguage=A;if (!triv$(C).prop('checked')) triv$(C).prop('checked','true').click();}};function jsWndImage(){var A=this;jsWndObj.prototype.constructor.call(A);A.selected=A.designTime?!!wndPage.cropTool:0;A.arEffects=[new jsWndShadow(),new jsWndReflection()];for (var i=0;i<A.arEffects.length;i++){A.arEffects[i].srcWndType=1;}};jsWndImage.prototype=new jsWndObj();jsWndImage.prototype.constructor=jsWndImage;jsWndImage.prototype.attach=function(A){var B=this,C=n;var D=B.rcdGetAttData();var E=D.objData;jsWndObj.prototype.attach.call(B,A);var F=B.cwObj;if(E.shadoweffect&&E.shadoweffect.bHasShadow) F.shadoweffect=E.shadoweffect;if(E.reflectioneffect&&E.reflectioneffect.bHasReflection) F.reflectioneffect=E.reflectioneffect;F.rotateEffect=E.rotateEffect;F.desktopRect=E.desktopRect;if (A&&B.dCon) C=B.dCon.src;B.dCon=B.div.getElementsByTagName('IMG')[0];if (C&&(B.rcdState.firedActions&8)) B.dCon.src=C;B.processEffects(B.arEffects);};jsWndImage.prototype.isVisible=function(){return (this.currTrans?t:jsWndObj.prototype.isVisible.call(this));};jsWndImage.prototype.changeContents=function(A,B,C){var D=this;if (D.dCon){var E=D.designTime?A.getLink():A;if (!D.designTime&&theApp.is.ie6){if (D.dCon.src.indexOf('.png')==D.dCon.src.length-4){D.div.style.filter='';D.dCon.style.filter='';};if (E.indexOf('.png')==E.length-4){D.div.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+E+"',sizingMethod='scale')";D.dCon.style.filter='progid:DXImageTransform.Microsoft.Alpha(opacity=0)';}};D.dCon.src=E;if (C==u) D.rcdState.firedActions|=8;D.processEffects(D.arEffects);}};jsWndImage.prototype.getWndEffect=function(A){var B=this;for (var i=0;i<B.arEffects.length;i++){if (B.arEffects[i].effType==A) return B.arEffects[i];}};function jsWndButton(){jsWndObj.prototype.constructor.call(this);};p=jsWndButton.prototype=new jsWndObj();p.constructor=jsWndButton;p.attach=function(A){var B=this,C=B.rcdGetAttData().objData;jsWndObj.prototype.attach.call(B,A);B.dCon=B.div.getElementsByTagName('IMG')[0];B.src=C.res;B.clickSrc=C.resClick;B.overSrc=C.resOver;B.div.style.cursor="pointer";};p.mouseDown=function(e){if(!this.editMode()) this.dCon.src=this.clickSrc;return jsWndObj.prototype.mouseDown.call(this,e);};p.mouseUp=function(e){var A=this;if(!(A.editMode())){A.dCon.src=theApp.is.mobile?A.src:A.overSrc;if(A.bLButtonDown) A.parPage.doAction(A.cwObj.actItem,n,A.cwObj);};return jsWndObj.prototype.mouseUp.call(A,e);};p.mouseMove=function(e){if(this.editMode()) return jsWndObj.prototype.mouseMove.call(this,e);};p.mouseEnter=function(){if(!(this.editMode())){this.dCon.src=this.bLButtonDown?this.clickSrc:this.overSrc;return jsWndObj.prototype.mouseEnter.call(this);}};p.mouseExit=function(){if((!this.editMode())&&this.dCon){this.dCon.src=this.src;return jsWndObj.prototype.mouseExit.call(this);}};function jsWndAnimImage(){jsWndObj.prototype.constructor.call(this);};p=jsWndAnimImage.prototype=new jsWndObj();p.constructor=jsWndAnimImage;p.attach=function(A){var B=this,C=B.rcdGetAttData().objData;jsWndObj.prototype.attach.call(B,A);B.bIsFlash=C.isFlash;B.getFlashObj();B.dCon=B.div.getElementsByTagName(B.bIsFlash?'DIV':'IMG')[0];};p.getFlashObj=function(){var A=this;if (!A.bIsFlash) return f;try {if (!A.flshObj){var B=A.div.getElementsByTagName('embed')[0];if (!B.TotalFrames) B=A.div.getElementsByTagName('object')[0];if (!B.TotalFrames) B=null;A.flshObj=B;}} catch (e) {if (A.designTime) theApp.error(e);};return A.flshObj;};p.fReadyChk=function(A,B){B=B?B:0;if (B>4) return f;var C=this;var D=C.getFlashObj();var E=t;if ((!D)||typeof(D.PercentLoaded)=='undefined'||D.PercentLoaded()!=100){setTimeout(function(){A.call(C,++B);},100);E=f;};return E;};p.play=function(A){if (this.fReadyChk(this.play,A)) this.flshObj.Play();};p.stop=function(A){if (this.fReadyChk(this.stop,A)){this.flshObj.GotoFrame(0);this.flshObj.StopPlay();}};p.togglePlay=function(A){if (this.fReadyChk(this.play,A)){if (this.flshObj.IsPlaying()) this.flshObj.StopPlay();else this.play();}};p.pause=function(A){if (this.fReadyChk(this.pause,A)) this.flshObj.StopPlay();};p.gotoNextFrame=function(A){if (this.fReadyChk(this.gotoNextFrame,A)){var B=this.flshObj.CurrentFrame()+1;this.flshObj.GotoFrame(B);}};p.gotoPrevFrame=function(A){if (this.fReadyChk(this.gotoPrevFrame,A)){var B=this.flshObj.CurrentFrame()-1;this.flshObj.GotoFrame(B);}};p.gotoLabel=function(A){var B=this.getFlashObj();if(B) B.TGotoLabel('/',A);};p.setVariable=function(A,B){var C=this.getFlashObj();if(C) C.SetVariable(A,B);};p.getVariable=function(A){var B=this.getFlashObj();if(B) return B.GetVariable(A);return 0;};p.isPlaying=function(){var A=this.getFlashObj();if(A) return A.IsPlaying();return t;};p.gotoFrame=function(A){var B=this.getFlashObj();if(B) B.GotoFrame(A);};p.callFunction=function(A,B,C){var D=n;var E=this;if (!C) C=0;else if (C>4) return;var F=this.getFlashObj();if(F&&typeof F[A]!="undefined"){if(B==null||B=='') D=F[A]();else D=F[A](B);}else setTimeout(function(){E.callFunction(A,B,++C);},250);return D;};p.isDone=function(){var A=this.getFlashObj();if(!A||(typeof A.CurrentFrame=="undefined"&&typeof A.FrameNum=="undefined")) return;var B=parseInt(typeof A.CurrentFrame!="undefined"?A.CurrentFrame():A.FrameNum)+1;var C=parseInt(typeof(A.TotalFrames)=='function'?A.TotalFrames():A.TotalFrames);if((!A.IsPlaying()&&this.autoPlay)||B>=C) {this.onDone();window.clearInterval(this.hasDone);}};function jsBgSound(){var A=this;A.audio=n;};p=jsBgSound.prototype=new jsWndObj();p.constructor=jsBgSound;p.attach=function(A){var B=this.getTitleMgrDoc();if (B){this.setPlayingState(B.bBkgAudPlaying!=u?B.bBkgAudPlaying:1);var C=B.getElementById("bkgrndAud");if (A&&!C){C=B.createElement("audio");C.id="bkgrndAud";C.src=A;C.orgsrc=A;C.controls="false";C.hidden="true";C.autoplay="true";C.loop="loop";C.style.display="none";B.body.appendChild(C);this.bkaud=C;}else if (A&&C&&C.orgsrc!=A){C.src=A;C.orgsrc=A;}else if (!A&&C){B.body.removeChild(C);C=n;};this.bkaud=C;if (C&&!B.bBkgAudPlaying) this.stop();}};p.play=function(){var A=this;if (A.bkaud){A.bkaud.play();A.setPlayingState(t);}};p.togglePlay=function(){var A=this;if (A.bkaud){if (A.isPlaying()) A.bkaud.pause();else A.bkaud.play();A.setPlayingState(!A.isPlaying());}};p.pause=function(){if (this.bkaud){this.bkaud.pause();this.setPlayingState(f);}};p.stop=function(){if (this.bkaud){this.bkaud.currentTime=0;this.bkaud.pause();this.setPlayingState(f);}};p.actionMute=function(){if (this.bkaud) this.bkaud.muted=t;};p.actionUnMute=function(){if (this.bkaud) this.bkaud.muted=f;};p.isPlaying=function(){var A=this.getTitleMgrDoc();return A?A.bBkgAudPlaying:f;};p.setPlayingState=function(A){var B=this.getTitleMgrDoc();if (B) B.bBkgAudPlaying=A;};p.getTitleMgrDoc=function(){var A=n;try{A=getTitleMgrWnd(window,0);if (A) A=A.document;}catch (e) {};A=A?A:window.document;return A;};function jsWndAudio(){jsWndObj.prototype.constructor.call(this);};p=jsWndAudio.prototype=new jsWndObj();p.constructor=jsWndAudio;p.isVisible=function(){return (this.div&&this.div.style.visibility!='hidden'&&!this.initHidden);};p.show=function(){var A=this;if (!A.isValidWndObj()) return;if (A.initHidden){var B=A.rtRect;var C=A.div.style;var D=A.name;C.left=B.x+'px';C.top=B.y+'px';C.width=B.width+'px';C.height=B.height+'px';if (A.cwObj.iDisplay==2){var E=['swf'+D,'embed'+D,D+'obj'];for (var i=0;i<E.length;i++){var F=document.getElementById(E[i]);if (F){F.width=B.width;F.height=B.height;}};A.snd.div.style.visibility='inherit';var G=A.snd.div.getElementsByTagName('div');if (G&&G.length) G[0].style.display='none';};A.snd.show();};A.initHidden=f;if (A.useHTML5Player()&&A.cwObj.iDisplay==2&&A.mePlayer){if (A.mePlayer) A.mePlayer.controls=t;};jsWndObj.prototype.show.call(A);};p.hide=function(){var A=this;if (!A.isValidWndObj()) return;A.manualHide=t;if (A.useHTML5Player()&&A.cwObj.iDisplay==2){if (A.mePlayer) A.mePlayer.controls=f;};jsWndObj.prototype.hide.call(A);};p.attach=function(A,B,C){var D=this,E=D.cwObj,F=D.rcdGetAttData(),G=F.htmlId,H=(B!=u),I=(D.rcdState.firedActions&8)!=0,J=(E==u||!(E instanceof cwObjPub))?t:f,K=D.__prevResource!=F.resource;B=B?B:F.objData;jsWndObj.prototype.attach.call(D,A);E=D.cwObj;D.name=G;E.arEvents=F.arEvents;if (typeof D.initHidden=='undefined') D.initHidden=B.initHidden;var L=(D.initHidden!=B.initHidden);D.initHidden=B.initHidden;if (D.manualHide){D.div.style.visibility='inherit';};E.iDisplay=B.iDisplay;D.snd=new jsSound();var M=document.getElementById("snd"+G);D.snd.div=M;if (M&&(J||H||(!I&&K))){if (D.mePlayer){try {D.mePlayer.play=function(){};D.mePlayer.pause();D.mePlayer.remove();if (D.mePlayer.player) D.mePlayer.player.globalUnbind();if (D.mePlayer.player) delete(mejs.players[D.mePlayer.player.id]);D.mePlayer=n;D.snd.mePlayer=n;} catch (e){if (window.console&&window.console.error) console.error('error cleaning up mejs player');}};triv$(M).empty();M.innerHTML=H?C:F.stdHtml;M.tObj=D;D.__prevResource=F.resource;};D.snd.audio=D;E.hasEvents=function(){return B.hasEvents;};E.supportsEvents=function(){return B.supportsEvents;};E.hasCaptions=B.hasCaptions;E.linkName=B.linkName;var N=E.hasCaptions?B.skinHeight+90:B.skinHeight,O=TRgEx.flashAudio.test(B.linkName)?'video':'audio';if (D.useHTML5Player()){D.mePlayer=triv$(O,M).mediaelementplayer({"loop":(E.wnd.dwFlags&0x80000?t:f),"enableAutosize":f,"hideVolumeOnTouchDevices":f,"defaultAudioWidth":D.rtRect.width,"defaultAudioHeight":N,"alwaysShowControls":t,"audioVolume":'vertical',"pauseOtherPlayers":f,"alwaysShowControls":t,"startLanguage":(window.VarTriCCState?VarTriCCState.getValue():'en'),"flashStreamer":B.flashStreamer,"success":function(Q,R){D.mePlayer=Q;D.snd.mePlayer=Q;if (D.dwFlags&0x20000||D.mePlayerDoPlay){D.mePlayerDoPlay=n;D.play();};triv$(Q).bind('ended',function(){D.onDone();});triv$('#'+Q.player.id+'_captions_en').prop('checked','true').click(function(){ trivPage.setCCState('en');});triv$('#'+Q.player.id+'_captions_none').prop('checked','true').click(function(){ trivPage.setCCState('none');});D.initEvents();triv$(".mejs-overlay-button,.mejs-overlay-loading",D.snd.div).css({ 'display':'none' });if(triv$.inArray(E.iDisplay,[1,0,3])>-1) triv$(".mejs-controls",D.snd.div).css({ 'visibility':'hidden' });},"features":['playpause','progress','current','duration','tracks','volume']})[0];triv$(O,D.snd.div).css({ visibility:"hidden"});if(E.hasCaptions){triv$(".mejs-captions-position,mejs-captions-position-hover",D.snd.div).css({'bottom':D.rtRect.height+6+'px'});};E.cssSkin=B.cssSkin;var P=triv$(".mejs-container,.mejs-audio",M);if (P.length>0){if(B.customSkinName) P[0].className+=' '+B.customSkinName;else if (E.iDisplay==0) P.css('left',D.rtRect.x+'px').css('right',D.rtRect.y+'px');else if (E.cssSkin) P[0].className+=" mejs-"+TRgEx.getSkinName(E.cssSkin);}};if (L) D.show();if (H) D.rcdState.firedActions|=8;};p.updateDiv=function(){var A=this.rcdGetAttData(),B=!!this.div;jsWndObj.prototype.updateDiv.call(this,B);if (!B&&A.objData.iDisplay!=2){var C=document.createElement('div');document.getElementById('wndPage').appendChild(C);C.innerHTML="";C.id='snd'+A.htmlId;C.style.position='absolute';C.style.left='0px';C.style.top='0px';C.style.width='1px';C.style.height='1px';C.style.opacity='.01';C.style.filter='alpha(opacity='+('1')+')';}};p.mouseDown=function(e){var A=this;if (!A.editMode()&&(A.cwObj.iDisplay==0||A.cwObj.iDisplay==3)){if (e.which==1||(e.which==n&&(e.button==0||e.button==1))) A.togglePlay();};return jsWndObj.prototype.mouseDown.call(A,e);};p.doAudioAction=function(){return ((!this.editMode())&&this.snd&&this.isValidWndObj());};p.play=function(){if (this.doAudioAction()) this.snd.play();};p.togglePlay=function(){if (this.doAudioAction()) this.snd.togglePlay();};p.pause=function(){if (this.doAudioAction()) this.snd.pause();};p.stop=function(){if (this.doAudioAction()) this.snd.stop();};p.isPlaying=function(){return (this.doAudioAction())?this.snd.isPlaying():f;};p.isResType=function(A){var B=this.cwObj;var C=(this.cwObj.res&&B.res.linkName)?B.res.linkName:(B.linkName?B.linkName:"");if (!C||!C.length||!A||!A.length) return 0;var D="";for (var i=0;i<A.length;i++){if (D.length) D+="|";D+=("\\."+A[i]);};if (!D.length) return 0;D=".*("+D+")$";var E=RegExp(D,"i");return E.test(C);};p.actionMute=function(){if (this.doAudioAction()) return this.snd.mute();};p.actionUnMute=function(){if (this.doAudioAction()) return this.snd.unMute();};p.isValidWndObj=function(){return 	this.cwObj!=u&&this.mePlayer!=u&&this.div.firstChild!=u;};function jsSound(){var A=this;A.audio=n;A.bPlaying=0;A.winMgrId=n;A.flsPlayer=n;A.wmPlayer=n;A.wmEventHandlerScripts=[];};p=jsSound.prototype=new jsWndObj();p.constructor=jsSound;p.show=function(){var A=this.audio.rtRect;triv$(this.div).css({left:'0px',top:'0px',width:A.width+'px',height:A.height+'px',opacity:'1',filter:'alpha(opacity=100)'});};p.play=function(){var A=this;if (A.editMode()) return;setTimeout(function(){if (A.div){var B=A.div.getElementsByTagName('embed');if (A.useHTML5Player()){if (A.mePlayer&&A.mePlayer.play) A.mePlayer.play();else{A.mePlayerDoPlay=t;return;}}else if ((A.audio.cwObj.supportsEvents()||B.length==0)&&theApp.is.ie){A.setWmPlayer();if (A.wmPlayer&&A.wmPlayer.controls) A.wmPlayer.controls.play();}else{var C=(typeof B[0].controls=='object'?B[0].controls:B[0]);if (C){if (typeof C.pause!=='undefined'&&(!this.isOldWM(C)||C.playState!==3)){C.play();}else if (typeof C.Step!=='undefined'){var D=C.GetPluginStatus();if (!D) return;if (D.IContains('waiting')||D.IContains('playable')){setTimeout(function(){A.play();},100);return;};if (!D||!D.IContains('complete')) return;C.Play();}else if (typeof C.DoPause!=='undefined'){if (!A.bPlaying) C.DoPlayPause();}else{A.resetEmbed((A.audio.cwObj.dwFlags&0x80000>0),t);}}};A.bPlaying=1;}},150);};p.togglePlay=function(){var A=this;if (A.div){var B=A.div.getElementsByTagName('embed');if (A.useHTML5Player()){if (A.bPlaying) A.mePlayer.pause();else A.mePlayer.play();}else if ((A.audio.cwObj.supportsEvents()||B.length==0)&&theApp.is.ie){A.setWmPlayer();if (A.wmPlayer&&A.wmPlayer.controls){A.setPlayState(A.wmPlayer);if (A.bPlaying) A.wmPlayer.controls.pause();else A.wmPlayer.controls.play();}}else{var C=(typeof B[0].controls=='object'?B[0].controls:B[0]);if (C){A.setPlayState(C);if (typeof C.pause!=='undefined'){if (A.bPlaying) C.pause();else C.play();}else if (typeof C.Step!=='undefined'){var D=C.GetPluginStatus();if (!D) return;if (D.IContains('waiting')||D.IContains('playable')){setTimeout(function(){A.togglePlay();},100);return;};if (!D.IContains('complete')) return;if (A.bPlaying) C.Stop();else C.Play();}else if (typeof C.DoPause!=='undefined'){C.DoPlayPause();}}};A.bPlaying=(A.bPlaying==1?0:1);}};p.pause=function(){var A=this;if (A.div){var B=A.div.getElementsByTagName('embed');if (A.useHTML5Player()){A.mePlayer.pause();}else if ((A.audio.cwObj.supportsEvents()||B.length==0)&&theApp.is.ie){A.setWmPlayer();if (A.wmPlayer&&A.wmPlayer.controls) A.wmPlayer.controls.pause();}else{var C=(B.length?(typeof B[0].controls=='object'?B[0].controls:B[0]):n);if (C){if (typeof C.pause!=='undefined'){C.pause();}else if (typeof C.Step!=='undefined'){var D=C.GetPluginStatus();if (!D||!D.IContains('complete')) return;C.Stop();}else if (typeof C.DoPause!=='undefined'){C.DoPause();}}};A.bPlaying=0;}};p.stop=function(){var A=this;if (A.div){var B=A.div.getElementsByTagName('embed');if (A.useHTML5Player()){A.mePlayer.pause();if(A.mePlayer.readyState>0) A.mePlayer.currentTime=0;}else if ((A.audio.cwObj.supportsEvents()||B.length==0)&&theApp.is.ie){A.setWmPlayer();if (A.wmPlayer&&A.wmPlayer.controls) A.wmPlayer.controls.stop();}else{var C=(B.length?(typeof B[0].controls=='object'?B[0].controls:B[0]):n);if (C){if (typeof C.pause!=='undefined'){C.stop();}else if (typeof C.Step!=='undefined'){var D=(typeof C.GetPluginStatus!=='undefined'?C.GetPluginStatus():"complete");if (!D||!D.IContains('complete')) return;C.Stop();if (typeof C.Rewind!=='undefined') C.Rewind();}else if (typeof C.DoPause!=='undefined'){C.DoStop();}else{A.resetEmbed(f,f);}}};A.bPlaying=0;}};p.mute=function(A) {var B=this;if (B.div){if (B.useHTML5Player()){if (B.mePlayer.setMuted) B.mePlayer.setMuted(A==u);}}};p.unMute=function(){this.mute('unmute');};p.setPlayState=function(A){var B=this;if (!A){var C=['audio','embed','object'];for (var i=0;i<C.length;i++){A=B.div.getElementsByTagName(C[i]);if (A) A=A[0];if (A) break;}};B.bPlaying=jsWndVideo.getPlayState(A,B.isOldWM(A),B.audio.useHTML5Player());return B.bPlaying;};p.resetEmbed=function(A,B){var C=this.div;var D=null;for (var i=0;!D&&C.childNodes&&i<C.childNodes.length;i++) if (C.childNodes[i]&&C.childNodes[i].setAttribute) D=C.childNodes[i];if (D){D.setAttribute("loop",A);D.setAttribute("autostart",B);C.innerHTML=C.innerHTML;}};p.setFlashPlayer=function(){var A=this;if (A.flsPlayer) return;if (theApp.is.ie10orLess){var B=A.audio.cwObj;var C=(B.iDisplay==0||B.iDisplay==3?'Audio':'');A.flsPlayer=document['swf'+A.audio.name+C];}else{var D=A.div.getElementsByTagName('object');if (D.length&&typeof D[0].PercentLoaded!='undefined'){A.flsPlayer=D[0];}else{D=A.div.getElementsByTagName('embed');if (D.length&&typeof D[0].PercentLoaded!='undefined'){A.flsPlayer=D[0];}}}};p.setWmPlayer=function(){if (this.wmPlayer) return;if (theApp.is.ie){this.wmPlayer=document[this.audio.name+'obj'];}else{var A=this.div.getElementsByTagName('object');if (A&&A.length>0) this.wmPlayer=(theApp.is.Mac?A[0]:A[0].getElementsByTagName('embed')[0]);}};p.isPlaying=function(){this.setPlayState();return this.bPlaying;};p.isOldWM=function(A){return (A&&theApp.is.ie10orLess&&typeof A.playState!='undefined'&&(typeof A.versionInfo=='undefined')&&this.audio.isResType(["mp3","wav","au","midi"]));};function jsWndVideo(){this.bPlaying=0;jsWndObj.prototype.constructor.call(this);};p=jsWndVideo.prototype=new jsWndObj();p.constructor=jsWndVideo;p.isVisible=function(){return (this.div&&this.div.style.visibility!='hidden'&&!this.initHidden);};p.show=function(){var A=this;if (!A.isValidWndObj()) return;if (A.initHidden){var B=A.rtRect;triv$(A.div).css({left:B.x+'px',top:B.y+'px',width:B.width+'px',height:B.height+'px',opacity:'1',filter:'alpha(opacity=100)'});triv$('video, object, embed',A.div).attr({width:B.width,height:B.height});};A.initHidden=f;jsWndObj.prototype.show.call(A);};p.attach=function(A,B,C){var D=this,E=D.cwObj,F=D.rcdGetAttData(),G=F.htmlId,H=(B!=u),I=(D.rcdState.firedActions&8)!=0,J=(E==u||!(E instanceof cwObjPub))?t:f,K=D.__prevResource!=F.resource;B=B?B:F.objData;D.dCon=D.div.getElementsByTagName('DIV')[0];if(!J&&(H||(!I&&K))) D.stop();jsWndObj.prototype.attach.call(D,A);if (!D.isValidWndObj()) return;E=D.cwObj;D.name=G;E.arEvents=F.arEvents;if (typeof D.initHidden=='undefined') D.initHidden=B.initHidden;var L=(D.initHidden!=B.initHidden);D.initHidden=B.initHidden;if (J||H||(!I&&K)){if (!J){try{var M=D.dCon;var N=M.parentNode;M.innerHTML='';N.removeChild(M);var O=document.createElement('div');O.id=M.id;O.style.cssText=M.style.cssText;N.appendChild(O);D.wmPlayer=n;D.flsPlayer=n;D.dCon=O;}catch(e) {  }};D.dCon.innerHTML=F.stdHtml;D.__prevResource=F.resource;};if (D.useHTML5Player()){var P=(B.bRollOver)?t:f;D.mePlayer=triv$('video',D.div).mediaelementplayer({"loop":(E.wnd.dwFlags&0x80000?t:f),"enableAutosize":t,"enablePluginSmoothing":t,"hideVolumeOnTouchDevices":f,"defaultVideoWidth":480,"defaultVideoHeight":270,"audioVolume":'vertical',"alwaysShowControls":(P?f:t),"hideVideoControlsOnLoad":(P?f:t),"videoWidth":E.wnd.rtRect.width,"videoHeight":(P)?E.wnd.rtRect.height:E.wnd.rtRect.height-B.skinHeight,"pauseOtherPlayers":f,"startLanguage":(window.VarTriCCState?VarTriCCState.getValue():'en'),"iPadUseNativeControls":f,"iPhoneUseNativeControls":f,"AndroidUseNativeControls":f,"flashStreamer":B.flashStreamer,"success":function(T,U){D.mePlayer=T;if(!T.player) T.player=U.player;if (D.dwFlags&0x20000||D.mePlayerDoPlay){D.mePlayerDoPlay=n;D.play();};triv$(T).bind('ended',function(){D.onDone();if(E.wnd.dwFlags&0x80000) D.play();});D.initEvents();if(T.player){triv$('#'+T.player.id+'_captions_en').prop('checked','true').click(function(){ trivPage.setCCState('en');});triv$('#'+T.player.id+'_captions_none').prop('checked','true').click(function(){ trivPage.setCCState('none');});if(P) triv$(".mejs-controls",D.div).css('bottom','0px');if (T.player) T.player.detectFullscreenMode();var Q=T.player.enterFullScreen;var R=T.player.exitFullScreen;T.player.enterFullScreen=function(){Q.call(this);if(!theApp.is.iOS&&!theApp.is.safari){this.fixForFullScreenPos=this.container.find('.mejs-controls').css('bottom');this.container.find('.mejs-controls').css('bottom','0px');}};T.player.exitFullScreen=function(){R.call(this);if(!theApp.is.iOS&&!theApp.is.safari){this.container.find('.mejs-controls').css('bottom',this.fixForFullScreenPos);}};T.addEventListener('canplay',function(e) {if(!theApp.is.ie11&&!theApp.is.ie10orLess&&!theApp.is.ieEdge){triv$('.mejs-overlay-button',D.div).hide();triv$('.mejs-overlay-loading',D.div).parent().show();}},false);T.addEventListener('play',function(e) {triv$('.mejs-overlay-loading',D.div).parent().hide();triv$('.mejs-overlay-button',D.div).show();},false);if(theApp.is.ie9){D.mePlayer.setVideoSize(E.wnd.rtRect.width,(P)?E.wnd.rtRect.height:E.wnd.rtRect.height-B.skinHeight);}}},"features":['playpause','progress','current','duration','tracks','volume','fullscreen']})[0];E.cssSkin=B.cssSkin;if(P) this.dCon.style.backgroundColor="transparent";if(B.customSkinName) triv$(".mejs-container,.mejs-video",D.div)[0].className+=' '+B.customSkinName;else if (B.useNoSkin){triv$(".mejs-container,.mejs-video",D.div)[0].className+=" mejs-noskin";triv$(".mejs-controls",D.div).find('*').hide();}else triv$(".mejs-container,.mejs-video",D.div)[0].className+=" mejs-"+TRgEx.getSkinName(E.cssSkin);};E.hasEvents=function(){return B.hasEvents;};E.supportsEvents=function(){return B.supportsEvents;};var S=D.div.getElementsByTagName("video");S=S.length?S[0]:n;if(L) D.show();if (H) D.rcdState.firedActions|=8;if(A){D.sizeTo(D.rtRect.width,D.rtRect.height-B.skinHeight);}};p.updateDiv=function(){var A=!!this.div;jsWndObj.prototype.updateDiv.call(this,A);};p.sizeTo=function(w,h){var A=this;if (!A.isValidWndObj()) return;jsWndObj.prototype.sizeTo.call(this,w,h);if(this.useHTML5Player()){var B=this.div.getElementsByTagName('video')[0];B.width=w;B.height=h;B.style.width=w+'px';B.style.height=h+'px';if(A.mePlayer){A.mePlayer.player.setPlayerSize(A.rtRect.width,A.rtRect.height);A.mePlayer.player.media.setVideoSize(A.rtRect.width,A.rtRect.height);A.mePlayer.player.setControlsSize();}}};p.play=function(){var A=this;if (A.editMode()||!A.isValidWndObj()) return;setTimeout(function(){if (A.dCon){var B=A.dCon.getElementsByTagName('embed');if (A.useHTML5Player()){if (A.mePlayer&&A.mePlayer.play) A.mePlayer.play();else{A.mePlayerDoPlay=t;return;}}else if ((A.cwObj.supportsEvents()||B.length==0)&&theApp.is.ie){A.setWmPlayer();if (A.wmPlayer&&A.wmPlayer.controls) A.wmPlayer.controls.play();}else if (B.length){var C=(typeof B[0].controls=='object'?B[0].controls:B[0]);if (C){if (typeof C.pause!=='undefined'){C.play();}else if (typeof C.Step!=='undefined'){var D=C.GetPluginStatus();if (!D) return;if (D.IContains('waiting')){setTimeout(function(){A.play();},100);return;};if (!D||!D.IContains('complete')) return;C.Play();}else if (typeof C.DoPause!=='undefined'){if (!A.bPlaying) C.DoPlayPause();}else{var E=A.dCon.innerHTML.replace('autostart="0"','autostart="1"');E=E.replace('<param name="autoStart" value="0"','<param name="autoStart" value="1"');A.dCon.innerHTML=E;}}};A.bPlaying=1;}},150);};p.togglePlay=function(){var A=this;if (!A.isValidWndObj()) return;if ((!A.editMode())&&A.dCon){var B=A.dCon.getElementsByTagName('embed');if (A.useHTML5Player()){if (A.bPlaying) A.mePlayer.pause();else A.mePlayer.play();}else if ((A.cwObj.supportsEvents()||B.length==0)&&theApp.is.ie){A.setWmPlayer();if (A.wmPlayer&&A.wmPlayer.controls){A.setPlayState(A.wmPlayer);if (A.bPlaying) A.wmPlayer.controls.pause();else A.wmPlayer.controls.play();}}else if (B.length){var C=(typeof B[0].controls=='object'?B[0].controls:B[0]);if (C){A.setPlayState(C);C=(typeof C.controls!=='undefined'&&C.controls!==''?C.controls:C);if (typeof C.pause!=='undefined'){if (A.bPlaying) C.pause();else C.play();}else if (typeof C.Step!=='undefined'){var D=C.GetPluginStatus();if (!D) return;if (D.IContains('waiting')){setTimeout(function(){A.togglePlay();},100);return;};if (!D.IContains('complete')) return;if (A.bPlaying) C.Stop();else C.Play();}else if (typeof C.DoPause!=='undefined'){C.DoPlayPause();}}};A.bPlaying=(A.bPlaying==1?0:1);}};p.pause=function(){var A=this;if (!A.isValidWndObj()) return;if ((!A.editMode())&&A.dCon){var B=A.dCon.getElementsByTagName('embed');if (A.useHTML5Player()){A.mePlayer.pause();}else if ((A.cwObj.supportsEvents()||B.length==0)&&theApp.is.ie){A.setWmPlayer();if (A.wmPlayer&&A.wmPlayer.controls) A.wmPlayer.controls.pause();}else if (B.length){var C=(typeof B[0].controls=='object'?B[0].controls:B[0]);if (C){if (typeof C.pause!=='undefined'){C.pause();}else if (typeof C.Step!=='undefined'){var D=C.GetPluginStatus();if (!D||!D.IContains('complete')) return;C.Stop();}else if (typeof C.DoPause!=='undefined'){C.DoPause();}}};A.bPlaying=0;}};p.stop=function(){var A=this;if (!A.isValidWndObj()) return;if ((!A.editMode())&&A.dCon){var B=A.dCon.getElementsByTagName('embed');if (A.useHTML5Player()){A.mePlayer.pause();if (A.mePlayer.readyState>0){A.mePlayer.currentTime=0;A.mePlayer.setCurrentTime(0);};if(theApp.is.ie8orLess){A.mePlayer.player.setCurrentTime(0);A.mePlayer.player.setCurrentRail();A.mePlayer.player.updateCurrent();}}else if ((A.cwObj.supportsEvents()||B.length==0)&&theApp.is.ie){A.setWmPlayer();if (A.wmPlayer&&A.wmPlayer.controls) A.wmPlayer.controls.stop();}else if (B.length){var C=((typeof B[0].controls=='object'||typeof B[0].controls=='function')?B[0].controls:B[0]);if (C){if (typeof C.pause!=='undefined'){C.stop();}else if (typeof C.Step!=='undefined'){var D=(typeof C.GetPluginStatus!=='undefined'?C.GetPluginStatus():"complete");if (!D||!D.IContains('complete')) return;C.Stop();if (typeof C.Rewind!=='undefined') C.Rewind();}else if (typeof C.DoPause!=='undefined'){C.DoStop();}else{var E=A.dCon.innerHTML.replace('autostart="1"','autostart="0"');E=E.replace('<param name="autoStart" value="1"','<param name="autoStart" value="0"');A.dCon.innerHTML=E;}}};A.bPlaying=0;}};p.isPlaying=function(){this.setPlayState();return this.bPlaying;};p.setPlayState=function(A){var B=this;if (!B.isValidWndObj()) return;if (!A){var C=['video','embed','object'];for (var i=0;i<C.length;i++){A=B.dCon.getElementsByTagName(C[i]);if (A) A=A[0];if (A) break;}};var D=jsWndVideo.getPlayState(A,n,B.useHTML5Player());B.bPlaying=(D===n?B.bPlaying:(D?1:0));return B.bPlaying;};jsWndVideo.getPlayState=function(A,B,C){var D=n;var E="WM";var F=n;var G=n;if (C){E='mejs';}else{if (!A) return n;if (typeof A.controls=='object') D=A.controls;if (typeof A.playState!='undefined') F=A.playState;else if (D&&typeof D.playState!='undefined') F=D.playState;else if (typeof A.GetRate!='undefined'){E="QT";var H=A.GetPluginStatus();if (!H||!H.IContains('complete')) return F;F=A.GetRate();}else if (D&&typeof D.GetRate!='undefined'){E="QT";var H=D.GetPluginStatus();if (!H||!H.IContains('complete')) return F;F=D.GetRate();}else if (typeof A.GetPlayState!='undefined'){E="Real";F=A.GetPlayState();}else if (D&&typeof D.GetPlayState!='undefined'){E="Real";F=D.GetPlayState();}};if (E=='WM'&&F!==n){switch (F){case 2:G=(B)?t:f;break;case 0:case 1:case 6:case 7:case 8:case 9:case 10:G=f;break;case 3:case 4:case 5:G=t;break;}}else if (E=='QT'&&F!==n){if (F==0) G=f;else G=t;}else if (E=='Real'&&F!==n){switch (F){case 0:case 4:G=f;break;case 1:case 2:case 3:case 5:G=t;break;}}else if (E=='Flash'){var J=n;if (A){if (A.wndObj) J=A.wndObj;else if (A.parentNode&&A.parentNode.wndObj) J=A.parentNode.wndObj;};G=J&&(J.playerState=='PLAYING'||J.playerState=='BUFFERING')?t:f;}else if (E=='mejs'){G=!A.paused;};return G;};p.setFlashPlayer=function(){if (this.flsPlayer) return;if (theApp.is.ie){this.flsPlayer=document['swf'+this.name];}else{var A=this.dCon.getElementsByTagName('object');if (A&&A.length>0) this.flsPlayer=(theApp.is.Mac?A[0]:A[0].getElementsByTagName('embed')[0]);}};p.setWmPlayer=function(){if (this.wmPlayer) return;if (theApp.is.ie){this.wmPlayer=document[this.name+'obj'];}else{var A=this.dCon.getElementsByTagName('object');if (A&&A.length>0) this.wmPlayer=(theApp.is.Mac?A[0]:A[0].getElementsByTagName('embed')[0]);}};p.actionMute=function(){if (!this.editMode()) return this.mute();};p.actionUnMute=function(){if (!this.editMode()) return this.unMute();};p.mute=function(A) {var B=this;if (!B.isValidWndObj()) return;if ((!B.editMode())&&B.dCon){if (B.useHTML5Player()){if (B.mePlayer&&B.mePlayer.setMuted) B.mePlayer.setMuted(A==u);}}};p.unMute=function(){this.mute("unmute");};function jsWndDocument(){jsWndObj.prototype.constructor.call(this);};p=jsWndDocument.prototype=new jsWndObj();p.constructor=jsWndDocument;p.attach=function(A){jsWndObj.prototype.attach.call(this,A);this.dCon=this.div.getElementsByTagName('IFRAME')[0];};p.changeContents=function(A){if (this.dCon) this.dCon.src=this.designTime?A.getLink():A;};function jsWndRefList(){jsWndObj.prototype.constructor.call(this);};p=jsWndRefList.prototype=new jsWndObj();p.constructor=jsWndRefList;p.isValidWndObj=function(){return 	this.cwObj!=u&&this.div.firstChild!=u;};function jsWndIpix(){jsWndObj.prototype.constructor.call(this);};p=jsWndIpix.prototype=new jsWndObj();p.constructor=jsWndIpix;function jsWndShape(){jsWndObj.prototype.constructor.call(this);this.arEffects=[new jsWndShadow(),new jsWndReflection()];for(var i=0;i<this.arEffects.length;i++){this.arEffects[i].srcWndType=21;}};p=jsWndShape.prototype=new jsWndObj();p.constructor=jsWndShape;p.attach=function(A){var B=this;var C=B.rcdGetAttData();var D=C.objData;jsWndObj.prototype.attach.call(B,A);B.dCon=B.div.getElementsByTagName('SVG')[0];if(!B.dCon) B.dCon=B.div.getElementsByTagName('IMG')[0];var E=B.cwObj;if(D.shadoweffect&&D.shadoweffect.bHasShadow) E.shadoweffect=D.shadoweffect;if(D.reflectioneffect&&D.reflectioneffect.bHasReflection) E.reflectioneffect=D.reflectioneffect;E.rotateEffect=D.rotateEffect;E.desktopRect=D.desktopRect;B.processEffects(B.arEffects);if(theApp.is.ie10orLess) B.div.style.backgroundImage="url('images/trivantis-blank.gif')";};p.sizeTo=function(w,h){var A=this;if(!A.writeContent) A.dCon=triv$(A.div).find("img")[0];jsWndObj.prototype.sizeTo.call(this,w,h);};p.isValidWndObj=function(){return 	this.cwObj!=u&&this.div.firstChild!=u;};p.getWndEffect=function(A){var B=this;for(var i=0;i<B.arEffects.length;i++){if(B.arEffects[i].effType==A) return B.arEffects[i];}};p.updateDiv=function(){var A=this;var B=A.rcdGetAttData();var C=B.objData;if(theApp.is.ie8orLess) B.innerHtml=C.fallbackImg;jsWndObj.prototype.updateDiv.call(this);};function jsWndTextButton(){jsWndShape.prototype.constructor.call(this);};p=jsWndTextButton.prototype=new jsWndShape();p.constructor=jsWndTextButton;p.attach=function(A){var B=this;var C=B.rcdGetAttData();var D=C.objData;jsWndShape.prototype.attach.call(B,A);B.imgDataNormal=D.imgDataNormal;B.imgDataOver=D.imgDataOver;B.imgDataDown=D.imgDataDown;B.imgDataDisabled=D.imgDataDisabled;B.svgDataNormal=D.svgDataNormal;B.svgDataOver=D.svgDataOver;B.svgDataDown=D.svgDataDown;B.svgDataDisabled=D.svgDataDisabled;B.setState(B.btnState?B.btnState:D.btnState);B.processEffects(B.arEffects);};p.swapSvgElem=function(A){var B=this.designTime?triv$(this.dSVG):triv$('svg',this.div);var C=document.createElement('div');C.innerHTML='<svg>'+A+'</svg>';B.children().remove();triv$('svg',C).children().each(function () {B.append(this);});if (B.find('path').length){B.find('path')[0].style.pointerEvents="auto";};this.processEffects(this.arEffects);};p.mouseDown=function(e){var A=this;A.correctCursor();if(A.isNotDisabled()){if(!A.editMode()){if (theApp.is.ie8orLess) A.dCon.src=A.imgDataDown;else A.swapSvgElem (A.svgDataDown);};return jsWndShape.prototype.mouseDown.call(A,e);}};p.mouseUp=function(e){var A=this;A.correctCursor();if(A.isNotDisabled()){if(!A.editMode()){if (theApp.is.ie8orLess) A.dCon.src=theApp.is.mobile?A.imgDataNormal:A.imgDataOver;else A.swapSvgElem (theApp.is.mobile?A.svgDataNormal:A.svgDataOver);};return jsWndShape.prototype.mouseUp.call(A,e);}};p.mouseMove=function(e){var A=this;A.correctCursor();if(A.isNotDisabled()){if(A.editMode()) return jsWndShape.prototype.mouseMove.call(A,e);}};p.mouseEnter=function(){var A=this;A.correctCursor();if(A.isNotDisabled()){if(!A.editMode()){if (theApp.is.ie8orLess) A.dCon.src=A.bLButtonDown?A.imgDataDown:A.imgDataOver;else A.swapSvgElem ((A.bLButtonDown?A.svgDataDown:A.svgDataOver));return jsWndShape.prototype.mouseEnter.call(A);}}};p.mouseExit=function(){var A=this;A.correctCursor();if(A.isNotDisabled()){if(!A.editMode()){if (theApp.is.ie8orLess) A.dCon.src=A.imgDataNormal;else A.swapSvgElem (A.svgDataNormal);return jsWndShape.prototype.mouseExit.call(A);}}};p.contextMenu=function(e){var A=this;if(A.isNotDisabled()) return jsWndShape.prototype.contextMenu.call(A,e);};p.isNotDisabled=function(){var A=this;if(!A.editMode()){if(A.runMode()) return (A.cwObj.currentState&&A.cwObj.currentState!=4);else return (A.btnState&&A.btnState!='disabled');};return true;};p.isDisabled=function(){return!this.isNotDisabled();};p.correctCursor=function(){var A=this;if(!A.editMode()){if(A.isDisabled()) triv$('svg',A.div).css('cursor','default');else triv$('svg',A.div).css('cursor','pointer');}};p.updateDiv=function(){var A=this;var B=A.rcdGetAttData();var C=B.objData;jsWndShape.prototype.updateDiv.call(A);if(C.btnState!='disabled') triv$('img',A.div).attr('src',C.imgDataNormal);else triv$('img',A.div).attr('src',C.imgDataDisabled);};p.setState=function(A){var B=this;if(A=="enabled"){B.btnState='enabled';if (theApp.is.ie8orLess) B.dCon.src=B.imgDataNormal;else B.swapSvgElem (B.svgDataNormal);}else{B.btnState='disabled';if (theApp.is.ie8orLess) B.dCon.src=B.imgDataDisabled;else B.swapSvgElem (B.svgDataDisabled);}};function jsWndOther(){jsWndObj.prototype.constructor.call(this);};p=jsWndOther.prototype=new jsWndObj();p.constructor=jsWndOther;p.attach=function(A){var B=this,C=B.rcdGetAttData(),D=C.objData,E=B.cwObj?B.cwObj.arChld:[];if (C){jsWndObj.prototype.attach.call(B,A);if (!B.cwObj.arChld||!B.cwObj.arChld.length) B.cwObj.arChld=E;if (B.div){var F=B.div.style;F.left=B.rtRect.x+'px';F.top=B.rtRect.y+'px';F.width=B.rtRect.width+'px';F.height=B.rtRect.height+'px';F.clip="rect(0,"+F.width+","+F.height+", 0)";}}else{if (!B.cwObj) B.cwObj={};if (D&&D.a){var G=D.a;B.actFlags=G[0];B.dwFlags=G[1];};B.parPage=trivPage;};trivArExec(B.arChld,function(o){if (!o.cwObj) o.cwObj={};o.cwObj.par=B;});};p.moveGrp=function(A,B){var C=9999;var D=9999;var E=this.arChld;var x,y;if (E) for(var i=0;i<E.length;i++){if (!E[i].div) continue;x=E[i].div.offsetLeft;y=E[i].div.offsetTop;if(x<C)C=x;if(y<D)D=y;};if (E) for(var i=0;i<E.length;i++){if (!E[i].div) continue;x=E[i].div.offsetLeft;y=E[i].div.offsetTop;E[i].moveTo(x-(C-A),y-(D-B));E[i].bHasMoved=t;}};p.transGrp=function(A,B,C,x,y,D,E){var F='notset',G=n;x=parseInt(x);y=parseInt(y);trivArExec(this.arChld,function(J){if (!J.div) return;var H=J.div.offsetLeft;var I=J.div.offsetTop;if (F=='notset') {F=H;G=I;};if(F>H) F=H;if(G>I) G=I;});trivArExec(this.arChld,function(K){if (!K.div) return;H=K.div.offsetLeft;I=K.div.offsetTop;doDivTrans(A,K.div,B,C,n,K,x+(H-F),y+(I-G),E);});};p.offset=function(A) {var B=0;var C=this.arChld;if (C){C.sort(function(a,b) { return (a.rtRect&&b.rtRect)?a.rtRect.y-b.rtRect.y:0;});for (var i=0;i<C.length;i++){var D=C[i];if (!D.div) continue;D.div.style.top=String(D.div.offsetTop+A)+"px";var E=D.div.offsetHeight;if (D instanceof jsWndText){D.div.style.height=D.dCon2.offsetHeight+'px';var F=D.div.offsetHeight-E;if (F>0) A+=F;};var G=D.div.offsetTop+D.div.offsetHeight;if(B<G) {B=G;}}};return B;};p.show=function(){if (this.div) return jsWndObj.prototype.show.call(this);trivArExec(this.arChld,function(o){if (o.show) o.show();if (o.matchLine) o.matchLine.style.visibility='visible';});};p.hide=function(){if (this.div) return jsWndObj.prototype.hide.call(this);trivArExec(this.arChld,function(o){if (o.hide) o.hide();if (o.matchLine) o.matchLine.style.visibility='hidden';});};p.toggleVisibility=function(){if (this.div) return jsWndObj.prototype.toggleVisibility.call(this);trivArExec(this.arChld,function(o){if (o.toggleVisibility) o.toggleVisibility();});};p.pubRGUpdate=function(){var A=this.cwObj.formVar.getValue();trivArExec(this.arChld,function(o){if (o.isValidWndObj()&&o.constructor===jsWndFormRadio) o.setCheck(o.dCtrl.value==A);});};p.updateDiv=function(){var A=this.rcdGetAttData(),B=A&&A.htmlId;if (B){var C=triv$('#'+B);if (C.length){C.remove();C.appendTo(document.getElementById('wndPage'));this.div=C.get(0);}}};p.isValidWndObj=function(){return 	this.cwObj!=u&&this.div.firstChild!=u;};function jsWndMenu(){jsWndObj.prototype.constructor.call(this);};p=jsWndMenu.prototype=new jsWndObj();p.constructor=jsWndMenu;p.attach=function(A){var i;var B=this;var C=B.rcdGetAttData();var D=C.objData;var E=C.htmlId;jsWndObj.prototype.attach.call(B,A);var F=B.cwObj;F.textColor=D.textColor;F.bgHLColor=D.bgHLColor;F.textHLColor=D.textHLColor;F.bgColor=D.bgColor;F.resBgImg=D.resBgImg;var G=[];F.arItems=G;F.res=D.res;F.resNotStarted=D.resNotStarted;F.resInProgress=D.resInProgress;var H={};H.textColor=D.subTextColor;H.bgHLColor=D.subBgHLColor;H.textHLColor=D.subTextHLColor;H.bgColor=D.subBgColor;H.resBgImg=D.subResBgImg;F.subMenu=H;B.div.tObj=B;B.div.bMain=1;var I=document.getElementsByTagName("DIV");var J=[];var K=new RegExp("^[^0-9]*([0-9]*)");K.test(E);var L=RegExp.$1;K=new RegExp("^(tmenu|item)"+L+".*$");for (i=0;i<I.length;i++) if (K.test(I[i].id)) J.push(I[i]);var M;var N=new RegExp("^item("+L+".*)$");for (i=0;i<J.length;i++){M=J[i];var O=document.compatMode=="BackCompat";if (O&&theApp.is.ie10orLess){var w=M.style.width,h=M.style.height;if (w) w=w.substring(0,w.length-2);if (h) h=h.substring(0,h.length-2);if (!isNaN(w)) M.style.width=(parseInt(w)+2)+'px';if (!isNaN(h)) M.style.height=(parseInt(h)+2)+'px';};if (N.test(M.id)){G.push({id:M.id,div:M,attached:t});}};for (i=0;i<G.length;i++){curNode=((G[i]&&G[i].div)?G[i].div.parentNode:n);while (curNode&&curNode.tagName=="DIV"){if (curNode.id&&curNode.id.indexOf("tobj")==0) { G[i].div.bSub=0;break;}else if (curNode.id&&curNode.id.indexOf("tmenu")==0) { G[i].div.bSub=1;break;};curNode=curNode.parentNode;}};var P=new RegExp("^tmenu("+L+".*)$");for (i=0;i<J.length;i++){M=J[i];if (P.test(M.id)){var Q=new jsPopMenu(B);Q.div=M;M.popM=Q;for (var j=0;j<G.length;j++){var R=G[j];if (R.id=="item"+RegExp.$1){R.popMenu=Q;break;}}}};if(A) B.updateIndicators();};p.updateDiv=function(){jsWndObj.prototype.updateDiv.call(this);var A=this.rcdGetAttData(),B=document.getElementById('wndPage'),C=document.getElementById('menuAddlHtml_'+A.htmlId);if (!C){C=document.createElement('div');C.setAttribute('id','menuAddlHtml_'+A.htmlId);B.appendChild(C);}else C.innerHTML='';if (A.additionalHtml) C.innerHTML=A.additionalHtml;};p.updateIndicators=function(){jsWndObj.prototype.updateIndicators.call(this);jsWndObj.prototype.updateIndicators.call(this,document.getElementById('menuAddlHtml_'+this.div.id).getElementsByTagName('IMG'));};p.mouseDown=function(e){if(this.editMode()) return jsWndObj.prototype.mouseDown.call(this,e);else menuMouseDown(e,this);};p.mouseUp=function(e){if(this.editMode()) return jsWndObj.prototype.mouseUp.call(this,e);else menuMouseUp(e,this);};p.mouseMove=function(e){if(this.editMode()) return jsWndObj.prototype.mouseMove.call(this,e);else menuMouseMove(e,this);};p.mouseEnter=function(){if(!this.editMode()) menuMouseEnter(this);};p.mouseExit=function(){if(!this.editMode()) menuMouseExit(this);};function menuMouseMove(e,A){var B=n;var C=A.cwObj;if(e.target) B=e.target;else if(e.srcElement) B=e.srcElement;while(B){if(B&&B.id&&B.id.indexOf('item')==0) break;B=B.parentNode;};if(B){var D=menuFindItemByID(B.id,C.arItems);var E;if(D){D.div=B;if(A.currItem!=D){E=B.bSub&&B.bSub!=0;var F=E?C.subMenu:C;B.style.backgroundColor=((F.bgHLColor==-1||F.bgHLColor=='')?'transparent':F.bgHLColor);B.style.color=F.textHLColor;if(D.arrow) menuChangeArrowColor(B,F.textHLColor);if(A.currItem&&A.currItem.div){E=A.currItem.div.bSub&&A.currItem.div.bSub!=0;var G=E?C.subMenu:C;A.currItem.div.style.backgroundColor=((G.bgColor==-1||G.bgColor==''||G.resBgImg)?'transparent':G.bgColor);A.currItem.div.style.color=G.textColor;if(A.currItem.arrow) menuChangeArrowColor(A.currItem.div,G.textColor);};var H=A.currPopMenu;if(H&&H!=D.popMenu){H.hide();H=0;};if(D.popMenu){D.popMenu.show(A);A.currPopMenu=D.popMenu;};A.currItem=D;}}}};function findItemDiv(e,A){var B=(e.target)?B=e.target:(e.srcElement)?e.srcElement:n;while(B){if(B&&B.id&&B.id.indexOf('item')==0) break;B=B.parentNode;};return B;};function hideSubMenus(A,B){if((B instanceof jsPopMenu)&&(B.isDescendantOf(A))){B.toggleView();}else hideSubMenu(A);};function topWndMenu(A){if(A&&A.par) return topWndMenu(A.par);else return A;};function hideSubMenu(A){if(A.currPopMenu){A.currPopMenu.hide();A.currPopMenu=0;return t;}};function toggleSubMenu(A,B){if(!hideSubMenu(A)){showSubMenu(A,B);}};function showSubMenu(A,B){if(B&&B.popMenu){if(A.currPopMenu&&A.currPopMenu!==B.popMenu) hideSubMenu(A);A.currPopMenu=B.popMenu;};if(A.currPopMenu) A.currPopMenu.show(A);};function resetMenus(A,B){for(var i=0,C=B.length;i<C;i++){if(B[i] instanceof jsWndMenu){var D=A&&(A instanceof jsPopMenu)&&(A.isDescendantOf(B[i]));if(B[i]!==A&&!D){hideSubMenus(B[i],A);}}}};function menuMouseEnter(A){A.mouseIn=1;};function menuMouseExit(A){if(A&&A.mouseIn){var B=A.currItem.div.bSub&&A.currItem.div.bSub!=0;var C=B?A.cwObj.subMenu:A.cwObj;var D=A.currItem.div.style;D.backgroundColor=((C.bgColor==-1||C.bgColor==''||C.resBgImg)?'transparent':C.bgColor);D.color=C.textColor;if(A.currItem.arrow) menuChangeArrowColor(A.currItem.div,C.textColor);};A.currItem=0;A.mouseIn=0;};function menuMouseDown(e,A){A.bLButtonDown=1;};function menuMouseUp(e,A){try{if (A.bLButtonDown){var B=findItemDiv(e,A);if(B){var C=menuFindItemByID(B.id,A.cwObj.arItems);if(C&&!C.bSep){C.div=B;var D=topWndMenu(A);if(!C.attached) D.parPage.doAction(C.actItem,n,A.cwObj);if(A.currItem===C) toggleSubMenu(A,C);else showSubMenu(A,C);}}}} finally{A.bLButtonDown=0;}};function menuFindItemByID(A,B){for(var i=0;i<B.length;i++){var C=B[i];if(C.id==A) return C;if(C.arItems){C=menuFindItemByID(A,C.arItems);if(C) return C;}};return n;};function menuChangeArrowColor(A,B){A=A.nextSibling;for(var i=0;i<4;i++){if(!A) break;A.style.backgroundColor=B;A=A.nextSibling;}};function jsPopMenu(A){var B=this;B.par=A;B.mouseIn=0;B.timer=0;B.currItem=0;B.currPopMenu=0;B.cwObj=A.cwObj;};p=jsPopMenu.prototype=new jsWndObj();p.constructor=jsPopMenu;p.show=function(A){var B=this;if (A) B.par=A;B.div.style.visibility='visible';B.timer=setTimeout(function(){B.menuTimeOut();},1000);};p.hide=function(){if(this.currPopMenu) this.currPopMenu.hide();this.div.style.visibility='hidden';this.par.currPopMenu=0;if(this.timer) clearTimeout(this.timer);this.timer=0;};p.toggleView=function(){if(this.par.currPopMenu) this.hide();else this.show();};p.isDescendantOf=function(A){if(this.par) if(this.par instanceof jsWndMenu) return this.par===A&&this.par.currPopMenu===this;else if(this.par instanceof jsPopMenu) return this.par===A||this.par.isDescendantOf(A);};p.menuTimeOut=function(){var A=this;if(!A.div||A.div.style.visibility!='visible') return;if(!A.mouseIn&&!A.par.mouseIn&&!A.currPopMenu){A.div.style.visibility='hidden';A.par.currPopMenu=0;}else A.timer=setTimeout(function(){A.menuTimeOut();},1000);};p.mouseEnter=function(){menuMouseEnter(this);};p.mouseMove=function(e){menuMouseMove(e,this);};p.mouseExit=function(){menuMouseExit(this);};p.mouseDown=function(e){menuMouseDown(e,this);};p.mouseUp=function(e){menuMouseUp(e,this);};function jsWndTOC(){jsWndObj.prototype.constructor.call(this);};p=jsWndTOC.prototype=new jsWndObj();p.constructor=jsWndTOC;p.attach=function(A){var B=this,C=B.rcdGetAttData().objData;jsWndObj.prototype.attach.call(B,A);var D=(C&&C.iAppear==2)?'SELECT':'DIV';B.dCon=B.div.getElementsByTagName(D)[0];B.res=C.res;B.resNotStarted=C.resNotStarted;B.resInProgress=C.resInProgress;if (A) B.updateIndicators();};p.expand=function(A,B,C,D){if ((!A||A.tagName!='IMG')&&D){var E=document.getElementById(D);var F=(E?E.childNodes:n);if (E) for (var i=0;i<F.length;i++){if (F[i].id=='expandImg'){A=F[i];break;}}};if (!A||A.tagName!='IMG') return;if(A.style.visibility=='hidden')return;var G=A.parentNode.parentNode;if(A.src.indexOf(B)>=0){A.src=A.src.replace(B,C);var H=G.getElementsByTagName('UL')[0];H.style.display='block';}else if(A.src.indexOf(C)>=0){A.src=A.src.replace(C,B);G.getElementsByTagName('UL')[0].style.display='none';}};p.scrollTo=function(A){if(!this.div) return;var B=n;var C=this.div.getElementsByTagName('DIV');if (C) for(var D=0;D<C.length;D++) {if(C[D]&&(C[D].id=='toc'||C[D].className=='DLG_treeview')){B=C[D];break;}};if(!B) return;var E='trivExitPage("'+A;var F=B.getElementsByTagName('LI');if(!F||!F.length) F=B.getElementsByTagName('P');if(!F) return;for(var D=F.length-1;D>=0;D--){var H=F[D];if(H.className=='DLG_selected'||H.innerHTML.indexOf(E)>-1){var I=H.offsetTop;if(I<5) I=0;else if (theApp.is.ie10orLess&&H.tagName=='P'){if((I+H.scrollHeight)>(B.scrollTop+B.clientHeight)||I<B.scrollTop){I+=H.scrollHeight;I-=B.clientHeight;}else I=0;};if(I) B.scrollTop=I;break;}}};function jsWndProgressBar(){jsWndObj.prototype.constructor.call(this);this.barPos=0;this.step=0;this.range=0;};p=jsWndProgressBar.prototype=new jsWndObj();p.constructor=jsWndProgressBar;p.attach=function(A){var B=this,C=B.rcdGetAttData().objData;jsWndObj.prototype.attach.call(B,A);var D=B.cwObj;B.dCon=B.div.getElementsByTagName('DIV')[0];if (!B.isValidWndObj()) return;B.dBkgnd=B.dCon.getElementsByTagName('DIV')[0];B.dBar=B.dBkgnd.getElementsByTagName('DIV')[0];B.step=C.step;B.range=C.range;B.barPos=C.barPos;D.tickTime=C.tickTime;D.dwBarFlags=C.dwBarFlags;if (C.varName){D.pbVar=window[C.varName];B.setBarPosition(D.pbVar.getValue());};if (C.imgsrc){B.bImg=new Image();B.bImg.onload=function(){B.createBarImgs();};B.bImg.src=C.imgsrc;};if (D.dwBarFlags&0x20&&D.dwBarFlags&0x8) B.play();};p.stepIt=function(A){if (!this.isValidWndObj()) return;var B=Number(this.barPos),C=Number(this.step);B+=(A==undefined||A==""||A=="0")?C:(-C);return this.setBarPosition(B);};p.setPosition=function(A){if (!this.isValidWndObj()) return;if (this.cwObj.dwBarFlags&0x10) return this.setBarPosition(A);};p.isPlaying=function(){if (!this.isValidWndObj()) return;return ((this.cwObj.dwBarFlags&0x8)&&this.timer);};p.play=function(){var A=this;if (!A.isValidWndObj()) return;if (!A.cwObj.dwBarFlags&0x8) return 0;else if (A.timer) return A.barPos;else{A.timer=setTimeout(function(){A.onTimer();},A.cwObj.tickTime);return 1;}};p.stop=function(){var A=this;if (!A.isValidWndObj()) return;A.pause();A.setBarPosition(0);return 0;};p.pause=function(){var A=this;if (!A.isValidWndObj()) return;if (!A.cwObj.dwBarFlags&0x8) return 0;else if (A.timer){clearTimeout(A.timer);A.timer=0;};return A.barPos;};p.togglePlay=function(){if (!this.isValidWndObj()) return;if (this.isPlaying()) this.pause();else this.play();};p.onTimer=function(){var A=this;if (!A.isValidWndObj()) return;if (A.stepIt("0")>=A.range){A.timer=0;if (A.actFlags&0x40) A.issueActions(6);}else A.timer=setTimeout(function(){A.onTimer();},A.cwObj.tickTime);};p.setBarPosition=function(A){var B=this;if (B.cwObj&&B.cwObj.pbVar!=null) B.cwObj.pbVar.set(A.toString());if (!B.isValidWndObj()) return;A=parseInt(A);if (typeof A!='number'||isNaN(A)) A=0;if (A>B.range) A=B.range;else if (A<0) A=0;B.barPos=A;var C=A/B.range;var D=B.cwObj.dwBarFlags;var E=B.dBar.style;if (D&0x1){C*=B.rtRect.height;C=Math.round(C);if (D&0x80) C=B.rtRect.height-C;E.left='0px';E.top=(B.rtRect.height-C)+'px';E.width='100%';E.height=C+'px';}else{C*=B.rtRect.width;C=Math.round(C);if (D&0x80) C=B.rtRect.width-C;E.left='0px';E.top='0px';E.width=C+'px';E.height='100%';};return A;};p.createBarImgs=function(){var A=this;if (!A.isValidWndObj()) return;var B=A.cwObj.dwBarFlags;triv$('img',A.dBar).remove();if (A.bImg){var C=B&0x1?A.rtRect.height:A.rtRect.width;var D=B&0x1?A.bImg.height:A.bImg.width;for (var i=0;i<C;i+=D){var E=document.createElement('img');E.src=A.bImg.src;E.style.position='absolute';if (B&0x1){E.style.left='0px';E.style.top=i+'px';E.style.width='100%';E.style.height=A.bImg.height+'px';}else{E.style.left=i+'px';E.style.top='0px';E.style.width=A.bImg.width+'px';E.style.height='100%';};A.dBar.appendChild(E);}}};function jsWndStatusIndicator(){jsWndObj.prototype.constructor.call(this);};p=jsWndStatusIndicator.prototype=new jsWndObj();p.constructor=jsWndStatusIndicator;p.attach=function(A){var B=this,C=B.rcdGetAttData().objData;jsWndObj.prototype.attach.call(B,A);B.dCon=B.div.getElementsByTagName('IMG')[0];if (!B.isValidWndObj()) return;B.res=C.res;B.resNotStarted=C.resNotStarted;B.resInProgress=C.resInProgress;if (A) B.updateIndicator(B.status);};p.changeContents=function(A,B){if (this.dCon){if(A==n){this.dCon.style.visibility='hidden';return;};this.dCon.style.visibility='';var C=this.designTime?A.getLink():A;if (!this.designTime&&theApp.is.ie6){if (this.dCon.src.indexOf('.png')==this.dCon.src.length-4){this.div.style.filter='';this.dCon.style.filter='';};if (C.indexOf('.png')==C.length-4){this.div.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+C+"',sizingMethod='scale')";this.dCon.style.filter='progid:DXImageTransform.Microsoft.Alpha(opacity=0)';}};this.dCon.src=C;var D="";var E=-1;if(this.dCon.alt&&B){D=this.dCon.alt;var E=D.indexOf('-Completed');if (E==-1) E=D.indexOf('-In Progress');if (E==-1) E=D.indexOf('-Not Started');if (E>0) D=D.substring(0,E)+B;this.dCon.alt=D;};if(this.dCon.title&&B){D=this.dCon.title;var E=D.indexOf('-Completed');if (E==-1) E=D.indexOf('-In Progress');if (E==-1) E=D.indexOf('-Not Started');if (E>0) D=D.substring(0,E)+B;this.dCon.title=D;}}};p.updateIndicator=function(A){var B=this;B.status=A;if(A=="notstarted") B.changeContents(B.resNotStarted,"-Not Started");else if(A=="inprogress") B.changeContents(B.resInProgress,"-In Progress");else B.changeContents(B.res,"-Completed");};function jsWndForm(){};jsWndForm.prototype.attach=function(A){jsWndObj.prototype.attach.call(this,A);var B=this.rcdGetAttData().objData;var C=this.cwObj;C.objType=11;C.formType=B.formType;C.dwFormFlags=B.dwFormFlags;};function jsWndFormEntry(){jsWndObj.prototype.constructor.call(this);};p=jsWndFormEntry.prototype=new jsWndObj();p.constructor=jsWndFormEntry;p.numberOnlyKeyPressedHandler=function(A) {if (!A) A=window.event;var B=A.target?A.target:A.srcElement;var C=A.keyCode||A.which;var D=B.value;if(A.which!==undefined&&(A.which===0||A.which===8)){return;}else if(C===46){if(!D){ B.value='0';};if(D==='-'){ B.value='-0';}else if(D.indexOf('.')!=-1){ cancelEvent(A);}}else if(C===43&&D.indexOf('-')===0){B.value=D.substr(1);}else if(C===45){if(D){if(D.indexOf('-')===-1){ B.value='-'+D;};cancelEvent(A);}}else if(C===44){if(!D){ B.value='0';};if(D==='-'){ B.value='-0';}else if(D.indexOf('.')!=-1){ cancelEvent(A);}else if(D.slice(-1)===','){ cancelEvent(A);}}else if(C<48||C>57) {cancelEvent(A);}};p.attach=function(A){var B=this,C=B.rcdGetAttData().objData;jsWndForm.prototype.attach.call(B,A);var D=B.div.getElementsByTagName('textarea');B.dCon=(D&&D.length?D[0]:B.div.getElementsByTagName('input')[0]);B.cwObj.iNumChars=C.iNumChars;};p.update=function(A,B,C,D){var E=this;if (!E.isValidWndObj()) return;if (!E.trivAlert){var F=E.dCon;if (F.value.length>B){if (D&&trivAlert){E.trivAlert=t;trivAlert(D,'',C,function(){E.trivAlert=f;var G=F.onpropertychange;F.onpropertychange=n;try{F.value=F.value.substring(0,B);if (F.value.length>B) F.value=F.value.replace(/\r\n$/,'');}finally{F.onpropertychange=G;}});F.blur();}else{alert(C);F.focus();};F.value=F.value.substring(0,B);return f;};A.set(F.value);}};p.changeContents=function(A){if (!this.isValidWndObj()) return;this.dCon.value=A;if(this.cwObj.formVar) this.cwObj.formVar.set(A);};p.reset=function(){if (!this.isValidWndObj()) return;this.dCon.value=this.cwObj.strDefValue;this.onChange();};p.updateDiv=function(){var A=n,B=n,C=n,D=this.dCon;if (D){A=this.rcdGetAttData().innerHtml;B=document.createElement("div");B.innerHTML=A;C=B.getElementsByTagName(D.tagName)[0];};jsWndObj.prototype.updateDiv.call(this,(D?t:f));if (C) D.style.cssText=C.style.cssText;A=n;B=n;C=n;};function jsWndFormRadio(){jsWndObj.prototype.constructor.call(this);};p=jsWndFormRadio.prototype=new jsWndObj();p.constructor=jsWndFormRadio;p.attach=function(A){var B=this,C=false,D=B.rcdGetAttData().objData;if (A) C=(B.dCtrl?B.dCtrl.checked:false);jsWndForm.prototype.attach.call(B,A);B.name=D.htmlId;var E=B.div.getElementsByTagName('DIV')[0];B.dCon=E;if (!B.isValidWndObj()) return;B.dCtrl=E.getElementsByTagName('INPUT')[0];B.dLbl=E.getElementsByTagName('LABEL')[0];if (A) this.dCtrl.checked=C;};p.setCheck=function(A){var B=this;if (!B.isValidWndObj()) return;B.dCtrl.checked=A;var C=!B.bHSTransparent&&(this.cwObj.formType==1?(A?theApp.cr_on:theApp.cr_off):(A?theApp.cc_on:theApp.cc_off));if (C)	B.dLbl.style.backgroundImage="url('"+C+"')";};p.getCheck=function(){if (!this.isValidWndObj()) return;return this.dCtrl.checked;};p.changeContents=function(A){if (!this.isValidWndObj()) return;this.setCheck(A&&A.length);if(this.cwObj.formVar) this.cwObj.formVar.set(A);};p.reset=function(A){if (!this.isValidWndObj()) return;this.setCheck(this.cwObj.dwFormFlags&0x2);if(!A) this.onChange();};p.onClick=function(e){if (!this.isValidWndObj()) return;this.setCheck(this.cwObj.formType==1?1:this.dCtrl.checked);if(this.designTime) return this.onChange();};function jsWndFormList(){jsWndObj.prototype.constructor.call(this);};p=jsWndFormList.prototype=new jsWndObj();p.constructor=jsWndFormList;p.attach=function(A){var B=this,C='';if (A) C=(B.dCon?B.dCon.value:'');jsWndForm.prototype.attach.call(B,A);var D=B.div.getElementsByTagName('SELECT')[0];B.dCon=D;if (!B.isValidWndObj()) return;if (A) B.dCon.value=C;};p.changeContents=function(A){if (!this.isValidWndObj()) return;this.setSel(A);if(this.cwObj.formVar) this.cwObj.formVar.set(A);};p.reset=function(A){var B=this;if (!B.isValidWndObj()) return;var C=-1;if (B.cwObj.arItems) for(var i=0;i<B.cwObj.arItems.length;i++){var D=B.cwObj.arItems[i];if(!A&&D.bSel){if(B.cwObj.dwFormFlags&0x20) B.dCon.options[i].selected=t;else C=i;}else if(B.cwObj.dwFormFlags&0x20) B.dCon.options[i].selected=f;};if(!(B.cwObj.dwFormFlags&0x20)) B.dCon.selectedIndex=C;if (B.onChange) B.onChange();};p.setSel=function(A){if (!this.isValidWndObj()) return;var B=this.dCon.options;if (!A||A=="~~~null~~~"){this.dCon.value='';this.reset(t);return;};if(this.cwObj.dwFormFlags&0x20){for(var i=0;i<B.length;i++){var C=new RegExp("(?:^|[,])"+B[i].label+"(?:$|[,])");if (C.test(A)) B[i].selected=t;else B[i].selected=f;}}else{this.dCon.value=A;}};p.getSel=function(){if (!this.isValidWndObj()) return;if(this.cwObj.dwFormFlags&0x20){var A='';var B=this.dCon.options;for(var i=0;i<B.length;i++) if(B[i].selected) A+=(A.length==0?'':',')+B[i].label;return A;}else return this.dCon.value;};function jsWndTestTimer(){jsWndObj.prototype.constructor.call(this);};p=jsWndTestTimer.prototype=new jsWndObj();p.constructor=jsWndTestTimer;p.changeContents=function(A){if (!this.isValidWndObj()) return;triv$('span',this.div).html(A);};p.attach=function(A){var B=this,C=B.rcdGetAttData().objData;jsWndObj.prototype.attach.call(B,A);var D=B.cwObj;D.dwTimerFlags=C.dwTimerFlags;D.iTimerTime=C.iTimerTime;D.name=C.publishName;D.id=C.id;D.timerVar=window["Var"+C.timerVarName];D.bAutoStart=C.bAutoStart;B.dCon=B.div.getElementsByTagName('DIV')[0];};p.play=function() {var A=this;if(A.cwObj.timerVar!=null) var B=A.cwObj.timerVar.getValue();if ((A.cwObj.timerVar.getValue().indexOf("pause:")!=-1)) B=parseInt(B.split(':')[1]);A.cwObj.timerVar.set((parseInt((new Date().getTime()+500)/1000)*1000)-B);};p.pause=function() {var A=this;if(A.cwObj.timerVar!=null&&!(A.cwObj.timerVar.getValue().indexOf("pause:")!=-1)) var B=A.cwObj.timerVar.getValue();if(B&&B!="NaN") A.cwObj.timerVar.set('pause:'+((parseInt((new Date().getTime()+500)/1000)*1000)-B));};p.stop=function(){var A=this;if(A.cwObj.timerVar!=null) A.cwObj.timerVar.set("pause:0");};p.togglePlay=function() {if(window[this.cwObj.timerVar]!=null){var A=window[this.cwObj.timerVar].getValue();if(typeof(A)=="string"&&A.indexOf('pause:')!=-1) this.play();else this.pause();}};jsWndTestTimer.trivTimerLoop=function(A,B,C,D,E,F){var G=A.getValue();var H=parseInt(G);var I=false;var J=parseInt((new Date().getTime()+500)/1000)*1000;if(typeof(G)=="string"){var K=G.indexOf("pause:")!=-1;var L=G.indexOf("done:")!=-1;if(K||L){var M=parseInt(G.split(':')[1]);H=(J-M);if(K) I=true;else{if(F) I=true;else A.set(H);}}};if((H==0||H>J)&&!I){H=J;A.set(H);};var N=eval(E);var O=jsWndTestTimer.getRemainingTime(J,H,B*1000,N.bShowHours,N.bShowMin,N.bShowSec,N.countdown);if(O==null&&!I){A.set("pause:-999999999999999");eval(C);}else{if(O==null) O=jsWndTestTimer.buildTimeString((N.countdown)?0:(B*1000),N.bShowHours,N.bShowMin,N.bShowSec);var P=eval(D);P(O);};var Q="jsWndTestTimer.trivTimerLoop("+A.name+","+B+",'"+C+"','"+D+"', '"+E+"', true )";setTimeout(Q,500);};jsWndTestTimer.getRemainingTime=function(A,B,C,D,E,F,G){B=parseInt(B/1000)*1000;var H=0;var I=0;var J=0;var A=parseInt((new Date().getTime()+500)/1000)*1000;if(B>A) return null;J=A-B;H=C-J;if (!G){I=C-H;if (I>C) return null;H=I;};if(G&&H>0||!G&&I<C) return jsWndTestTimer.buildTimeString(H,D,E,F,G);else return null;};jsWndTestTimer.buildTimeString=function(A,B,C,D){var E='';A=A/1000;var F=parseInt(A/3600);A-=F*3600;if (B){E+=F+':';}else E+='  ';F=parseInt(A/60);A-=F*60;if (C){if(F<=9) E+='0';E+=F;};if (D){if (C) E+=':';if(A<=9) E+='0';E+=parseInt(A);};return E;};function jsWndResults(){jsWndObj.prototype.constructor.call(this);};p=jsWndResults.prototype=new jsWndObj();p.constructor=jsWndResults;p.attach=function(A){var B=this,C=B.rcdGetAttData().objData,D=titleMgrHandle.arTests,E=n,h,F='';jsWndObj.prototype.attach.call(B,A);for (var i=0;i<D.length;i++){F+=(F?', ':'')+D[i].strLoadedName;if (D[i].strLoadedName==C.testName){E=D[i];break;}};if (E){E.dwTRFlags=C.dwTRFlags;E.bHorRule=C.bHorRule;E.horRuleColor=C.horRuleColor;E.horRuleWeight=C.horRuleWeight;E.bVertScroll=C.bVertScroll;E.settingsTest=C.settingsTest;E.settingsQCorr=C.settingsQCorr;E.settingsQIncorr=C.settingsQIncorr;E.settingsQUnans=C.settingsQUnans;E.defaultFont=C.defaultFont;titleMgrHandle.GetTestScore(E.strLoadedName);h=E.CreateTextResults(titleMgrHandle.strAiccSN,titleMgrHandle.arVars);if (h) B.div.innerHTML=h;if (E.bVertScroll){B.div.style.overflowY='scroll';}else{B.div.style.height='';B.rtRect.height=B.div.scrollHeight;}}else if (window.console&&window.console.error) console.error('Error showing Test Results. Test not found: ['+C.testName+']. Loaded tests: ['+F+']');};p.postAttach=function(A){this.updatePgHeightNObjsFromBotm(document.getElementById('wndPage'),arWnds);};p.updatePgHeightNObjsFromBotm=function(A,B,C){var D,E,F,G,H,I,J,K;var L=function(M){return M.dwFlags!=u?M.dwFlags:(M.cwObj?M.cwObj.dwFlags:n);};D=parseInt(A.style.height);F=0;G=0;trivArExec(B,function(N){K=L(N);if (K&0x1000){J=D-N.rtRect.y;if (J>G) G=J;}else{E=N.rtRect.y+N.rtRect.height;F=E>F?E:F;}});C=C==u?662:C;F+=30;H=F+G;H=H<C?C:H;I=H-D;A.style.overflow='';A.style.height=H+'px';if (this.designTime&&this.parPage){this.parPage.pageHeight=H;if (this.parPage.currPage) this.parPage.setPageBgImage(this.parPage.currPage.getBgImage());};trivArExec(B,function(O){K=K=L(O);if (K&0x1000){O.rtRect.y+=I;O.div.style.top=O.rtRect.y+'px';}});};function jsWndText(){jsWndObj.prototype.constructor.call(this);this.arEffects=[new jsWndShadow()];for (var i=0;i<this.arEffects.length;i++){this.arEffects[i].srcWndType=0;}};jsWndText.prototype=new jsWndObj();jsWndText.prototype.constructor=jsWndText;jsWndText.prototype.attach=function(A){var B=this,C=B.rcdGetAttData().objData;var D=B.rcdGetAttData();var E=D.objData;jsWndObj.prototype.attach.call(B,A);var F=B.cwObj;if(E.shadoweffect&&E.shadoweffect.bHasShadow) F.shadoweffect=E.shadoweffect;if(E.textShadowEffect&&E.textShadowEffect.bHasShadow) F.textShadowEffect=E.textShadowEffect;F.rotateEffect=E.rotateEffect;F.borderEffect=E.borderEffect;F.desktopRect=E.desktopRect;B.dCon=0;B.dCon2=0;trivArExec(B.div.getElementsByTagName('DIV'),function(H){var G=H.getAttribute("name");if (G=="dCon") B.dCon=H;else if (G=="dCon2") B.dCon2=H;if (B.dCon&&B.dCon2) return f;});B.dCon3=triv$('#dCon3',B.dCon)[0];B.cwObj.dwTextFlags=C.dwTextFlags;B.cwObj.marginSize=C.marginSize;if (B.__newContent) B.changeContents(B.__newContent);B.processEffects(B.arEffects);};jsWndText.prototype.changeContents=function(A,B){var C=this;var D=C.dCon2;if (D==n||C.inWriteContent) {if (!B||B<10) setTimeout(function(){C.changeContents(A,(B?++B:1));},200);return;};A=A=="~~~null~~~"?"":A;C.__newContent=A;A=(A&&A.replace?A.replace(/\n/g,"<br>"):A);var E=jsWndText.getFirstTextNode(D);if (E) {var F=[];while (E.parentNode!=D) {E=E.parentNode;F[F.length]=E;};if (F.length) {removeAllChildren(D,F);while (F[0].tagName&&F[0].tagName.toUpperCase()=="SPAN"&&!F[0].style.backgroundColor&&!F[0].style.fontFamily&&!F[0].style.fontSize&&!F[0].style.color){F[1].removeChild(F[0]);F.shift();};F[0].innerHTML=A;}else E=null;};if (!E) D.innerHTML='<p style="text-align:left"><span style="font-size:12pt;color:#000000;font-family:Arial,sans-serif">'+A+'</span></p>';};jsWndText.prototype.sizeTo=function(w,h){var A=this,B=A.cwObj,C=B.borderEffect;var D=C.borderWeight,E=B.marginSize,F=(C.outline?2:0),G=D*2+F;if (w<G) w=G;if (h<G) h=G;A.rtRect.width=w;A.rtRect.height=h;A.div.style.width=w+'px';A.div.style.height=h+'px';A.setdConWidth();A.setdConHeight();var H=(D+E)+'px';A.dCon2.style.left=H;A.dCon2.style.top=H;A.setTxtWidth(A.dCon2);A.setTxtHeight(A.dCon2);if (D){if (A.dCon3){A.dCon3.style.height=(A.rtRect.height-D*2-F)+'px';A.dCon3.style.width=(A.rtRect.width-D*2-F)+'px';}else{var I=(h-G)+'px',J=(w-G)+'px',K=(h-D-F)+'px',L=(w-D-F)+'px';triv$('#tbbt',dCon).css({'width':J});triv$('#tbbb',dCon).css({'width':J,'top':K});triv$('#tbbl',dCon).css({'height':I});triv$('#tbbr',dCon).css({'height':I,'left':L});triv$('#tbbbl',dCon).css({'top':K});triv$('#tbbtr',dCon).css({'left':L});triv$('#tbbbr',dCon).css({'left':L,'top':K});}}};jsWndText.prototype.setdConWidth=function(){var w=(this.rtRect.width-(this.cwObj.borderEffect.outline?2:0));this.dCon.style.width=(w<0?0:w)+'px';};jsWndText.prototype.setdConHeight=function(){var h=(this.rtRect.height-(this.cwObj.borderEffect.outline?2:0));this.dCon.style.height=(h<0?0:h)+'px';};jsWndText.prototype.setTxtWidth=function(A){var w=(this.rtRect.width-this.cwObj.borderEffect.borderWeight*2-this.cwObj.marginSize*2);A.style.width=(w<0?0:w)+'px';};jsWndText.prototype.setTxtHeight=function(A){var h=(this.rtRect.height-this.cwObj.borderEffect.borderWeight*2-this.cwObj.marginSize*2);A.style.height=(h<0?0:h)+'px';};jsWndText.prototype.isValidWndObj=function(){return 	this.cwObj!=u&&this.dCon!=u&&this.dCon2!=u&&this.div.firstChild!=u;};jsWndText.prototype.getWndEffect=function(A){var B=this;for (var i=0;i<B.arEffects.length;i++){if (B.arEffects[i].effType==A) return B.arEffects[i];}};jsWndText.getFirstTextNode=function(A){if (A){if(A.nodeType==3&&A.nodeValue!="\n") return A;else{for(var j=0;j<A.childNodes.length;j++){var B=jsWndText.getFirstTextNode(A.childNodes[j]);if(B) return B;}}};return n;};function jsRcdAttachData(){this.att_Desktop=n;this.att_TabletLandscape=n;this.att_TabletPortrait=n;this.att_PhoneLandscape=n;this.att_PhonePortrait=n;};function jsRcdState(){this.firedActions=0;this.visibility=n;};function jsFlashHandler(){};jsFlashHandler.FlashStateChange=function(A){if(A&&A.id&&A.newstate){var B=document.getElementById(A.id);if(B&&B.wndObj){B.wndObj.playerState=A.newstate;if(B&&A.newstate=='COMPLETED') {B.wndObj.onDone();B.wndObj.clearEventsFlag(-1);}}}};jsFlashHandler.FlashTimeChange=function(A){if(A&&A.id&&A.position&&A.duration){var B=document.getElementById(A.id);if(B&&B.cwObj){var C=B.cwObj.arEvents;if(C&&C.length>0) {for(var i=0;i<C.length;i++){var D=Number(C[i].value)/1000;if (!C[i].proc&&A['position']>=D&&A['position']<=A['duration']) {C[i].proc=true;B.wndObj.onEvent(C[i].name);}};B.wndObj.clearEventsFlag(A['position']);}}}};jsFlashHandler.getPlayer=function(A){if(theApp.is.ie10orLess) return(eval("document."+A));else{if (navigator.appVersion.indexOf("Mac")!=-1) return(eval(A));else{var B=document.getElementsByTagName('embed');for (var i=0;i<B.length;i++){if (B[i].name==A||B[i].id==A) return(window.document.embeds[i]);}}};if (theApp.is.ie) return(eval("document."+A));};jsFlashHandler.playerReadyRegister=function(A){jsFlashHandler.playerReadyRegCB=A;};jsFlashHandler.playerReadyUnRegister=function(){jsFlashHandler.playerReadyRegCB=n;};function playerReady(A){jsFlashHandler.playerState='IDLE';if(A&&A.id){var B=A.id;var C=document.getElementById(B);var D=n;if(C){var E=0;var F=function(){var G=jsFlashHandler.getPlayer(B);D=C.cwObj;if(!D){for(var i=0,H=C.parentNode;i<100&&H&&!H.tObj;i++) H=H.parentNode;if(H&&H.tObj){D=H.tObj.cwObj;C.wndObj=H.tObj;C.cwObj=H.tObj.cwObj;}};var I=f;if(D){if (D.arChld) for (var i=0;i<D.arChld.length;i++){var o=D.arChld[i];if (o.type==6&&o.on==6){I=t;break;}};G.addModelListener('STATE','jsFlashHandler.FlashStateChange');if(D.hasEvents()) {G.addModelListener('TIME','jsFlashHandler.FlashTimeChange');}};if(!D){if(E<5){E++;setTimeout(function() { F();},500);}else{window.status='Flash player not initialized properly. Events may not work.';setTimeout(function() { window.status='';},5000);}}};F();}};if (jsFlashHandler.playerReadyRegCB) jsFlashHandler.playerReadyRegCB(A);};function wndPageDrawLine(A,B,C,D,E,F){if(A>C){var t=A;A=C;C=t;t=B;B=D;D=t;};var G=Math.abs(C-A);var H=Math.abs(D-B);var I=(E==undefined?3:E);var J=0,K=0,L=0,M=0;var N=document.createElement('div');N.id='line';var O=N.style;O.position='absolute';O.left=Math.min(A,C)+'px';O.top=Math.min(B,D)+'px';O.width='1px';O.height='1px';O.zIndex=99000;this.div.appendChild(N);var P=function(Q,l,t,w,h,c){var R=document.createElement('div');var S=R.style;S.position='absolute';S.left=l+'px';S.top=t+'px';S.width=w+'px';S.height=h+'px';S.backgroundColor=(c==undefined?"#0000FF":c);S.overflow='hidden';Q.appendChild(R);};if(G>H){J=0;L=0;while(J<G){K=J;while ((Math.round(J*H/G)==L)&&(J<=G)) J++;P(N,(D>B?K:(G-J)),L,(J-K+I),I,F);L++;}}else{M=0;K=0;while(M<H){L=M;while((Math.round(M*G/H)==K)&&(M<H)) M++;P(N,(D>B?K:(G-K)),L,I,(M-L+I),F);K++;}};return N;};var svgNS="http://www.w3.org/2000/svg";function jsWndEffect(){var A=this;A.div=n;A.dCon=n;A.effType=n;A.srcWndType=n;};p=jsWndEffect.prototype;p.update=function(){};p.setZIndex=function(A){var B=this;if(B.div) B.div.style.zIndex=A;};p.getTransformCss=function(A){var B="";var C=A.div.style;var D=['-moz-transform','-webkit-transform','-o-transform','-ms-transform','filter','-ms-filter'];for(var i=0;i<D.length;i++){B+=D[i]+':'+C.transform+';';};return B;};p.destroy=function(){var A=this;triv$(A.dCon).remove();triv$(A.div).remove();A.dCon=n;A.div=n;};p.hex2RGBA=function(A,B){A=A.replace('#','');var r=parseInt(A.substring(0,2),16);var g=parseInt(A.substring(2,4),16);var b=parseInt(A.substring(4,6),16);if(typeof(B)!="undefined"){var a=a>1?1:parseFloat(B);return 'rgba('+r+','+g+','+b+','+a+')';}else return 'rgba('+r+','+g+','+b+',1.0)';};p.getSvgRect=function(A){var B,C,D,E,F;var G={"left":u,"top":u,"width":u,"height":u};if(A.editMode()) F=$(A.div).find("svg").get(0)?$(A.div).find("svg").attr("style").split(';'):u;else F=triv$(A.div).find("svg").get(0)?triv$(A.div).find("svg").attr("style").split(';'):u;if(!F) F=A.div.style;for(var i=0;i<F.length;i++){var H=F[i].split(':');switch(H[0].trim()){case "top":C=H[1];G.top=C;break;case "left":B=H[1];G.left=B;break;case "width":D=H[1];G.width=D;break;case "height":E=H[1];G.height=E;break;}};if(A.editMode()){G.top=G.height&&A.div.style.height?2*(parseInt(A.div.style.height)-parseInt(G.height))+"px":G.top;};return G;};p.getViewBox=function(A){if(A.editMode()||A.runMode()) return;var B;var C;var D=A.rcdGetAttData().innerHtml.indexOf("viewBox");if(D>-1){D=A.rcdGetAttData().innerHtml.indexOf('\"',D);var E=A.rcdGetAttData().innerHtml.indexOf('\"',D+1);B=A.rcdGetAttData().innerHtml.substring(D+1,E);var F=B.split(" ");C={"x":F[0],"y":F[1],"width":F[2],"height":F[3]};};return C;};p.getStrokeWidth=function(A){var B=triv$(A.div).find("path").get(0);if(!B) return 0;var C=triv$(B).attr("style");var D=C.indexOf("stroke-width:");if(D<0) return 0;var E=parseInt(C.substring(C.indexOf(":",D)+1,C.indexOf(";",D)));return E;};p.supportsSVG=function(){if(!document.createElementNS) return f;var A=document.createElementNS(svgNS,"svg");var B=document.createElementNS(svgNS,"feflood");var C=document.createElementNS(svgNS,"filter");var D=document.createElementNS(svgNS,"fegaussianblur");var E=document.createElementNS(svgNS,"feoffset");var F=document.createElementNS(svgNS,"fecomposite");var G=document.createElementNS(svgNS,"femerge");var H=document.createElementNS(svgNS,"femergenode");var I=A&&B&&C&&D&&E&&F&&G&&H?t:f;return I;};p.getPathOpacity=function(A){var B=1;var C;var D;if(A.editMode()||A.runMode()){if($(A.div).find("path").length>0) C=$(A.div).find("path").attr("style");}else{if(triv$(A.div).find("path").length>0) C=triv$(A.div).find("path").attr("style");};D=C?C.indexOf("opacity:"):-1;if(D>-1){D=C.indexOf(':',D)+1;B=parseFloat(C.substring(D,C.indexOf(';',D)));};return B;};function jsWndShadow(){jsWndEffect.prototype.constructor.call(this);this.effType=23;};p=jsWndShadow.prototype=new jsWndEffect();p.constructor=jsWndShadow;p.process=function(A){var B=this;if(A.div.children.length==0&&!A.dCon) return;var C=A.cwObj;if(!C.shadoweffect&&!C.textShadowEffect) return;var D=C.shadoweffect?C.shadoweffect.bHasShadow:undefined;switch(A.arEffects[0].srcWndType){case 1:if(D) B.processImage(A);else B.removeElement(A);break;case 21:if(D) B.processShape(A);else B.removeElement(A);break;case 22:if(D) B.processShape(A);else B.removeElement(A);break;case 0:B.processText(A);break;default:return;}};p.buildDefs=function(A){var B=this;var C=A.cwObj;var D=C.shadoweffect;var E=2*D.blurradius;var F=parseInt(A.div.style.width);var G=parseInt(A.div.style.height);var H=F+(2*E);var I=G+(2*E);var J=document.createElementNS(svgNS,"defs");var K=document.createElementNS(svgNS,"filter");var L=document.createElementNS(svgNS,"feOffset");var M=document.createElementNS(svgNS,"feFlood");var N=document.createElementNS(svgNS,"feGaussianBlur");var O=document.createElementNS(svgNS,"feComposite");var P=document.createElementNS(svgNS,"feMerge");var Q=document.createElementNS(svgNS,"feMergeNode");var R=document.createElementNS(svgNS,"feMergeNode");var S=B.getStrokeWidth(A);K.setAttributeNS(null,"id",A.div.id+"_SF");K.setAttributeNS(null,"filterUnits","userSpaceOnUse");K.setAttributeNS(null,"x",-1*(E+(S/2.0)+B.getOffsets(A).x));K.setAttributeNS(null,"y",-1*(E+(S/2.0)+B.getOffsets(A).y));var T=B.getViewBox(A);if(T){K.setAttributeNS(null,"width",3*(parseInt(T["width"])+(2*E)));K.setAttributeNS(null,"height",(parseInt(T["height"])+(2*E)));}else{K.setAttributeNS(null,"width",3*H+E);K.setAttributeNS(null,"height",I+E);};N.setAttributeNS(null,"in","SourceAlpha");N.setAttributeNS(null,"stdDeviation",(D.blurradius/1.7).toFixed(3));L.setAttributeNS(null,"result","offsetOutput");if(T) L.setAttributeNS(null,"dx",(2*(parseInt(T["width"])+(2*E)))-(B.getStrokeWidth(A)/2.0).toFixed(1));else L.setAttributeNS(null,"dx",(2*H)+E);L.setAttributeNS(null,"dy",-1*(B.getStrokeWidth(A)/2.0).toFixed(1));var U=D.color.replace('#','');var r=parseInt(U.substring(0,2),16);var g=parseInt(U.substring(2,4),16);var b=parseInt(U.substring(4,6),16);var W="rgba("+r+","+g+","+b+","+D.opacity+")";M.setAttributeNS(null,"flood-color",W);O.setAttributeNS(null,"in2","offsetOutput");O.setAttributeNS(null,"operator","in");R.setAttributeNS(null,"in","SourceGraphic");P.appendChild(Q);P.appendChild(R);K.appendChild(N);K.appendChild(L);K.appendChild(M);K.appendChild(O);K.appendChild(P);J.appendChild(K);return J;};p.processImage=function(A){var B=this;var C=A.dCon.src;B.updateDiv(A);if(!B.div) return;var D=A.cwObj.shadoweffect;var E=2*D.blurradius;var F=parseInt(A.div.style.width)+(2*E);var G=parseInt(A.div.style.height)+(2*E);var H=A.div.style.width;var I=A.div.style.height;var J=document.createElementNS(svgNS,"svg");J.id="svg"+A.div.id+"s";J.setAttributeNS(null,"style","overflow:hidden; width:"+F+"px; height:"+G+"px;");J.setAttributeNS(null,"focusable","false");var K=document.createElementNS(svgNS,"image");K.setAttributeNS("http://www.w3.org/1999/xlink",'href',C);K.setAttributeNS(null,'preserveAspectRatio','none');K.setAttributeNS(null,'width',H);K.setAttributeNS(null,'height',I);K.setAttributeNS(null,'y',0);K.setAttributeNS(null,'x',0);K.setAttributeNS(null,'transform','translate('+(-2*F)+' '+E+')');K.setAttribute('filter',"url(#"+A.div.id+"_SF)");K.setAttributeNS(null,'preserveAspectRatio','none');var L=B.buildDefs(A);J.appendChild(L);J.appendChild(K);triv$(B.div).empty();B.div.appendChild(J);};p.processShape=function(A){var B=this;B.updateDiv(A);if(!B.div) return;var C=A.cwObj.shadoweffect;var D=2*C.blurradius;var E=Number(A.div.style.width.replace("px"," "));var F=Number(A.div.style.height.replace("px"," "));var G=E+(2*D);var H=F+(2*D);if(D>E&&D>F){G=E;H=F;};var I=document.createElementNS(svgNS,"svg");var g=document.createElementNS(svgNS,"g");var J=triv$("#"+A.div.id).find("path").parent().get(0).getAttribute("transform");var K=0;var L=0;var M=B.getViewBox(A);var N=J.indexOf("translate");if(N>=0){if(M) K=(-2*(parseInt(M["width"])+(2*D)));else K=(-2*G);var O=J.substring(N,J.indexOf(")",N)-N+1);K+=B.getOffsets(A).x;L+=B.getOffsets(A).y;var P="translate("+K+' '+L+")";J=J.replace(O,P);g.setAttribute("transform",J);};I.id="svg"+A.div.id+"s";I.setAttributeNS(null,"style","overflow:hidden; width:"+G+"px; height:"+H+"px;");I.setAttributeNS(null,"focusable","false");if(M){var Q=divide(1.0,G)/divide(1.0,parseFloat(M["width"]));var R=divide(1.0,H)/divide(1.0,parseFloat(M["height"]));var S=B.getStrokeWidth(A);I.setAttributeNS(null,"viewBox",(parseInt(M["x"])-((D+(S/2.0))*Q)).toString()+" "+(parseInt(M["y"])-((D+(S/2.0))*R)).toString()+" "+(parseInt(M["width"])+(2*D*Q)).toString()+" "+(parseInt(M["height"])+(2*D*R)).toString());};var T=B.buildDefs(A);var U=triv$("#"+A.div.id).find("path");for(var i=0;i<U.length;i++){var d=triv$("#"+A.div.id).find("path").get(i).getAttribute("d");var W=triv$("#"+A.div.id).find("path").get(i).getAttribute("style");var X=document.createElementNS(svgNS,"path");X.setAttributeNS(null,"filter","url(#"+A.div.id+"_SF)");X.setAttributeNS(null,"d",d);X.setAttributeNS(null,"style",W);g.appendChild(X);};I.appendChild(T);I.appendChild(g);triv$(B.div).empty();B.div.appendChild(I);};p.getOffsets=function(A){var B={'x':0,'y':0};if(!A.editMode()&&!A.runMode()){var C=triv$(A.div).find("path");var g=triv$(C).parent();var D=triv$(C).get(0)?triv$(C).get(0).getAttribute("transform"):"";var E=triv$(C).get(0)?triv$(g).get(0).getAttribute("transform"):"";var F=0;var G;do{F=D.indexOf('(',F);if(F<0) break;G=D.search(/\s|\,/);var H=parseFloat(D.slice(F+1,G));B.x+=isNaN(H)?0:H;F=G;G=D.indexOf(')',F);var I=parseFloat(D.slice(F+1,G));B.y+=isNaN(I)?0:I;D=D.replace(D.slice(0,D.indexOf(")")+1),"").trim();F=D.indexOf('translate');}while(F>-1);do{F=E.indexOf('(',F);if(F<0) break;G=E.search(/\s|\,/);var H=parseFloat(E.slice(F+1,G));B.x+=isNaN(H)?0:H;F=G;G=E.indexOf(')',F);var I=parseFloat(E.slice(F+1,G));B.y+=isNaN(I)?0:I;E=E.replace(E.slice(0,E.indexOf(")")+1),"").trim();F=E.indexOf('translate');}while(F>-1);};return B;};p.updateDiv=function(A){var B=this;if(!A.div) return;var C=A.cwObj;B.div=document.createElement('div');B.div.id=A.div.id+'_shadow';if(!document.getElementById(B.div.id)){if(A.editMode()||A.runMode()){var D=window.locWndPage||wndPage;triv$(D.div).prepend(B.div);}else{triv$(wndPage).prepend(B.div);}};B.div=triv$('#'+B.div.id).get(0);var E=C.shadoweffect,F=E.depth,G=E.dir,H=E.blurradius,I=2*H;var J,K,L,M,N,O,P,Q,R=n,S,T,U,W,X;Q=parseInt(A.div.style.zIndex);L=360-G;S=(L)*(Math.PI/180.0);O=parseInt(B.calcSrcWidth(A)+(2*I));P=parseInt(B.calcSrcHeight(A)+(2*I));if(A.editMode()||A.runMode()){var Y;if(C.respProps) Y=C.respProps.desktop.rect;else Y=C.rect;T=(parseFloat(A.div.style.height)/Y.height);U=(parseFloat(A.div.style.width)/Y.width);}else{var Y=C.desktopRect;T=Y?parseFloat(A.div.style.height)/Y.height:1;U=Y?parseFloat(A.div.style.width)/Y.width:1;};F=Math.sqrt(Math.pow((F*Math.cos(S))*T,2)+Math.pow((F*Math.sin(S))*U,2));J=F*Math.cos((Math.PI/180.0)*L);K=F*Math.sin((Math.PI/180.0)*L);M=parseInt(B.calcSrcLeft(A)-I+J);N=parseInt(B.calcSrcTop(A)-I+K);X=A.div.style.visibility;W=A.div.style.clip;if(W){var a,b,c,d,e;e=W.indexOf('(');a=parseInt(W.slice(e+1,W.indexOf('px')));a-=I;e=W.indexOf(' ',e+1);b=parseInt(W.slice(e+1,W.indexOf('px',e)));b+=2*I;e=W.indexOf(' ',e+1);c=parseInt(W.slice(e+1,W.indexOf('px',e)));c+=2*I;e=W.indexOf(' ',e+1);d=parseInt(W.slice(e+1,W.indexOf('px',e)));d-=I;W='rect('+a+'px '+b+'px '+c+'px '+d+'px)';};if(!A.editMode()&&!A.runMode()){var f=1;var g=1;var h=1;var i=triv$(A.div).find("svg");f=A.div.style.opacity?parseFloat(A.div.style.opacity):1;if(i.length>0){h=i.get(0).style.opacity?i.get(0).style.opacity:1;R=f*h;}else if(A.dCon){g=A.dCon.style.opacity?parseFloat(A.dCon.style.opacity):1;R=f*g;}};var j='position: absolute;';j+='z-index: '+Q+';';j+='opacity:'+R+';';j+='visibility:'+X+';';j+=B.getTransformCss(A);j+='left: '+M+'px;';j+='top: '+N+'px;';j+='width: '+O+'px;';j+='height: '+P+'px;';j+='clip: '+W+';';j+='pointer-events:none;';if(A.editMode()||A.runMode()) $("#"+B.div.id).get(0).style.cssText=j;else triv$("#"+B.div.id).get(0).style.cssText=j;};p.removeElement=function(A){var B=this;if(!B.div) return;if(A.editMode()||A.runMode()) $("#"+B.div.id).remove();else triv$("#"+B.div.id).remove();if(B.fabObj) B.fabObj=n;if(B.fabCan) B.fabCan=n;};p.processText=function(A){var B=this;if(!A.div) return;var C,D,E;if(A.cwObj.shadoweffect&&A.cwObj.shadoweffect.bHasShadow){var F=A.cwObj.shadoweffect,G=F.blurradius,H=F.color,I=F.depth,J=F.dir,K=A.dCon&&A.dCon.style.opacity?F.opacity*parseFloat(A.dCon.style.opacity):F.opacity;E=360-J;C=I*Math.cos((Math.PI/180.0)*E).toFixed(1);D=I*Math.sin((Math.PI/180.0)*E).toFixed(1);var L=C+"px "+D+"px "+G+"px "+B.hex2RGBA(H,K);A.dCon.style.boxShadow=L;A.dCon.style.boxRadius="1px;";}else A.dCon.style.boxShadow=n;if(A.cwObj.textShadowEffect&&A.cwObj.textShadowEffect.bHasShadow){var M=A.cwObj.textShadowEffect,N=M.blurradius,O=M.color,P=M.depth,Q=M.dir,R=M.opacity;E=360-Q;C=P*Math.cos((Math.PI/180.0)*E).toFixed(1);D=P*Math.sin((Math.PI/180.0)*E).toFixed(1);var S=C+"px "+D+"px "+N+"px "+B.hex2RGBA(O,R);A.dCon.style.textShadow=S;}else A.dCon.style.textShadow=n;};p.calcSrcWidth=function(A){var B=parseInt(A.div.style.width);if(A.editMode()||A.runMode()){var C=$(A.div).find("canvas");if(C.length>0) B=$(C).attr("width");}else{var D=triv$(A.div).find("svg");if(D.length>0) B=triv$(D).attr("width");};return parseInt(B);};p.calcSrcHeight=function(A){var B=parseInt(A.div.style.height);if(A.editMode()||A.runMode()){var C=$(A.div).find("canvas");if(C.length>0) B=$(C).attr("height");}else{};return parseInt(B);};p.calcSrcLeft=function(A){var B=parseFloat(A.div.style.left);if(A.editMode()){var C=$(A.div).find("canvas");var D=C.length>0?$(C).get(0).parentElement:n;if(D) B=B+parseFloat(D.style.left);}else{};return parseFloat(B).toFixed(1);};p.calcSrcTop=function(A){var B=parseFloat(A.div.style.top);if(A.editMode()){var C=$(A.div).find("canvas");var D=C.length>0?$(C).get(0).parentElement:n;if(D) B=B+parseFloat(D.style.top);}else{};return parseFloat(B).toFixed(1);};p.hasShadow=function(A){var B=A.cwObj;var C=B.textShadowEffect?t:f;var D=B.shadoweffect?t:f;if(!C&&!D) return false;if(C&&B.textShadowEffect.bHasShadow) return true;if(D&&B.shadoweffect.bHasShadow) return true;return false;};p.updatePos=function(A){if(A.div.children.length==0&&!A.dCon) return;if(!this.hasShadow(A)) return;this.updateDiv(A);};function jsWndReflection(){jsWndEffect.prototype.constructor.call(this);this.effType=24;};p=jsWndReflection.prototype=new jsWndEffect();p.constructor=jsWndReflection;p.getYPos=function(A){var B=parseInt(A.div.style.top)+parseInt(A.div.style.height)+A.cwObj.reflectioneffect.separation;var C=this.getTransformCss(A);var D=C.indexOf("rotate");if(D<0) return B;var E=parseInt(C.slice(C.indexOf("(",D)+1,C.indexOf(")",D)))*(Math.PI/180.0);var F=[[Math.cos(E),-1*Math.sin(E)],[Math.sin(E),Math.cos(E)]];var G=[parseFloat(A.div.style.left)+divide(parseFloat(A.div.style.width),2.0),parseFloat(A.div.style.top)+divide(parseFloat(A.div.style.height),2.0)];var H=[parseFloat(A.div.style.left)-G[0],G[1]-parseFloat(A.div.style.top)];var I=[parseFloat(A.div.style.left)+parseFloat(A.div.style.width)-G[0],G[1]-parseFloat(A.div.style.top)];var J=[parseFloat(A.div.style.left)-G[0],G[1]-(parseFloat(A.div.style.top)+parseFloat(A.div.style.height))];var K=[parseFloat(A.div.style.left)+parseFloat(A.div.style.width)-G[0],G[1]-(parseFloat(A.div.style.top)+parseFloat(A.div.style.height))];var L=[[(H[0]*F[0][0])+(H[1]*F[1][0]),(H[0]*F[0][1])+(H[1]*F[1][1])],[(I[0]*F[0][0])+(I[1]*F[1][0]),(I[0]*F[0][1])+(I[1]*F[1][1])],[(J[0]*F[0][0])+(J[1]*F[1][0]),(J[0]*F[0][1])+(J[1]*F[1][1])],[(K[0]*F[0][0])+(K[1]*F[1][0]),(K[0]*F[0][1])+(K[1]*F[1][1])]];var M=L[0][0],N=L[0][0],O=L[0][1],P=L[0][1];for(var i=0;i<4;i++){if(L[i][0]<M) M=L[i][0];if(L[i][0]>N) N=L[i][0];if(L[i][1]>O) O=L[i][1];if(L[i][1]<P) P=L[i][1];};M=G[0]+M;N=G[0]+N;O=G[1]-O;P=G[1]-P;B+=2*(P-(parseFloat(A.div.style.top)+parseFloat(A.div.style.height)));return B.toFixed(1);};p.updateDiv=function(A){var B=this;if(!A.div) return;var C=A.cwObj,D=A.div.id+'_reflection',E=A.div.style;B.div=document.getElementById(D);if (!B.div){B.div=document.createElement('div');B.div.id=D;if (A.editMode()||A.runMode()){var F=window.locWndPage||wndPage;triv$(F.div).prepend(B.div);}else triv$(wndPage).prepend(B.div);};var G=parseInt(E.left),H=B.getYPos(A),I=parseInt(E.width),J=parseInt(E.height),K=E.zIndex,L=E.visibility,M=E.clip,N=n;if(A.editMode()) N=C.opacity/100.0;else{var O=1;var P=1;var Q=1;var R=triv$(A.div).find("svg");O=A.div.style.opacity?parseFloat(A.div.style.opacity):1;if(R.length>0){Q=R.get(0).style.opacity?R.get(0).style.opacity:1;N=O*Q;}else if(A.dCon){P=A.dCon.style.opacity?parseFloat(A.dCon.style.opacity):1;N=O*P;}};var S='position: absolute;left: '+G+'px;top: '+H+'px;width: '+I+'px;height: '+J+'px;z-index: '+K+';opacity:'+N+';clip:'+M+';pointer-events:none;visibility:'+L+';';var T=B.div.style;T.cssText=S;T.transform+="rotateX(180deg)";T.transform+=A.div.style.transform?A.div.style.transform:'';if(theApp.is.ie9){var U=A.div.style.cssText.indexOf("rotate(");if(U>-1){var W=parseInt(A.div.style.cssText.slice(A.div.style.cssText.indexOf("(",U)+1,A.div.style.cssText.indexOf(")",U)));W=180+W;T.cssText+="-ms-transform: scaleX(-1) rotate("+W+"deg);";}else T.cssText+="-ms-transform: scaleX(-1) rotate(180deg);";}};p.getShapeData=function(A){return A.canvas.toDataURL({format:'png'});};p.buildDefs=function(A,B){var C=this;var	D=A.cwObj.reflectioneffect;var E=document.createElementNS(svgNS,"defs");var F=0,G=A.cwObj.rotateEffect.angle,H=A.cwObj.flipV,I=A.cwObj.flipH;if((H==1&&I!=1)||(H!=1&&I==1)||(I==1&&H==1)) F=(1*G)*(Math.PI/180.0);else F=(-1*G)*(Math.PI/180.0);var J=Math.cos(F);var K=Math.sin(F);var L=(0.5-(0.5*K)).toFixed(2);var M=(0.5+(0.5*J)).toFixed(2);var N=(0.5+(0.5*K)).toFixed(2);var O=(0.5-(0.5*J)).toFixed(2);var P=document.createElementNS(svgNS,"linearGradient");P.id=B+"LG";if(C.bFlipV(A)){P.setAttributeNS(null,"x1",N);P.setAttributeNS(null,"y1",O);P.setAttributeNS(null,"x2",L);P.setAttributeNS(null,"y2",M);}else{P.setAttributeNS(null,"x1",L);P.setAttributeNS(null,"y1",M);P.setAttributeNS(null,"x2",N);P.setAttributeNS(null,"y2",O);};var Q=document.createElementNS(svgNS,"stop");Q.setAttributeNS(null,"offset","10%");Q.setAttributeNS(null,"stop-color","white");Q.setAttributeNS(null,"stop-opacity","0.5");var R=document.createElementNS(svgNS,"stop");R.setAttributeNS(null,"offset",parseFloat(D.offset*100)+"%");R.setAttributeNS(null,"stop-color","white");R.setAttributeNS(null,"stop-opacity","0");var S=document.createElementNS(svgNS,"mask");S.id=B+"M";S.setAttributeNS(null,"maskUnits","objectBoundingBox");S.setAttributeNS(null,"maskContentUnits","objectBoundingBox");var T=document.createElementNS(svgNS,"rect");T.setAttributeNS(null,"x","-0.1");T.setAttributeNS(null,"y","-0.1");T.setAttributeNS(null,"width",1.2);T.setAttributeNS(null,"height",1.2);T.setAttributeNS(null,"style","fill:url(#"+P.id+");");P.appendChild(Q);P.appendChild(R);S.appendChild(T);E.appendChild(P);E.appendChild(S);return E;};p.process=function(A){if(!A.div) return;if(A.div.children.length==0&&!A.dCon) return;var B=this;var C=A.cwObj;if(!C.reflectioneffect) return;var D=C.reflectioneffect?C.reflectioneffect.bHasReflection:undefined;if(!D) return;switch(A.arEffects[0].srcWndType){case 1:B.processImage(A);break;case 21:B.processShape(A);break;case 22:B.processShape(A);break;default:return;}};p.processImage=function(A){var B=this;B.updateDiv(A);if(!B.div) return;var C=document.createElementNS(svgNS,"svg");C.id="svg"+A.div.id+"r";var D=B.buildDefs(A,C.id);var E=A.dCon?A.dCon.src:n;C.setAttributeNS(null,"style","overflow:visible; width:"+A.div.style.width+"; height:"+A.div.style.height+";");C.setAttributeNS(null,"focusable","false");var F=document.createElementNS(svgNS,"image");F.setAttributeNS("http://www.w3.org/1999/xlink",'href',E);F.setAttributeNS(null,'preserveAspectRatio','none');F.setAttributeNS(null,'width',C.style.width);F.setAttributeNS(null,'height',C.style.height);F.setAttribute('mask',"url(#"+C.id+"M)");C.appendChild(D);C.appendChild(F);if(document.getElementById(C.id)){for(var i=0;i<B.div.children.length;i++){if(B.div.children[i].id==C.id){var G=document.createElement('div');G.appendChild(C);B.div.innerHTML=G.innerHTML;}}}else B.div.appendChild(C);B.dCon=C;};p.processShape=function(A){var B=this;B.updateDiv(A);if(!B.div) return;var C=document.createElementNS(svgNS,"svg");C.id="svg"+A.div.id+"r";var D=B.buildDefs(A,C.id);var E,F,G,H,I;I=B.getSvgRect(A);E=I.left!=u?I.left:A.div.style.left;F=I.top!=u?I.top:A.div.style.top;G=I.width!=u?I.width:A.div.style.width;H=I.height!=u?I.height:A.div.style.height;C.setAttributeNS(null,"style","position:relative; overflow:visible; width:"+G+"; height:"+H+"; left:"+E+"; top:"+F+";");C.setAttributeNS(null,"focusable","false");if(!A.editMode()&&!A.runMode()){var J=B.getViewBox(A);if(J) C.setAttributeNS(null,"viewBox",J["x"]+" "+J["y"]+" "+J["width"]+" "+J["height"]);};C.appendChild(D);if(A.editMode()){var K=B.getShapeData(A);var L=document.createElementNS(svgNS,"image");L.setAttributeNS("http://www.w3.org/1999/xlink",'href',K);L.setAttributeNS(null,'preserveAspectRatio','none');L.setAttributeNS(null,'width',parseFloat(G).toFixed(1));L.setAttributeNS(null,'height',parseFloat(H).toFixed(1));L.setAttribute('mask',"url(#"+C.id+"M)");C.appendChild(L);}else{var M=triv$(A.div).find("svg").children();for(var i=0;i<M.length;i++){var g=triv$(M[i]).clone();var N=triv$(g).find("path");for(var j=0;j<N.length;j++){N[j].setAttributeNS(null,"mask","url(#"+C.id+"M)");N[j].style.pointerEvents="none";};var O=triv$(g).find("text");for(var j=0;j<O.length;j++){O[j].setAttributeNS(null,"mask","url(#"+C.id+"M)");};C.appendChild(g.get(0));}};var P=document.getElementById(C.id);if(P){if(A.editMode()||A.runMode()) $(P).replaceWith(C);else triv$(P).replaceWith(C);}else B.div.appendChild(C);B.dCon=C;};p.bFlipV=function(A){var B=A.div.style.transform;if(B) return B.indexOf('scaleY')>-1?t:f;return f;};p.updatePos=function(A){if(A.div.children.length==0&&!A.dCon) return;var B=A.cwObj;if(!B.reflectioneffect) return;this.updateDiv(A);};p=n;
